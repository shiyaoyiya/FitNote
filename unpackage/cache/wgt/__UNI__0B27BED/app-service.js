if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((o=>t.resolve(e()).then((()=>o))),(o=>t.resolve(e()).then((()=>{throw o}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...o){uni.__log__?uni.__log__(e,t,...o):console[e].apply(console,[...o,t])}
/*!
   * pinia v2.1.7
   * (c) 2023 Eduardo San Martin Morote
   * @license MIT
   */
let o;const s=e=>o=e,n=Symbol();function a(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var i,l;(l=i||(i={})).direct="direct",l.patchObject="patch object",l.patchFunction="patch function";const c=()=>{};function r(t,o,s,n=c){t.push(o);const a=()=>{const e=t.indexOf(o);e>-1&&(t.splice(e,1),n())};return!s&&e.getCurrentScope()&&e.onScopeDispose(a),a}function d(e,...t){e.slice().forEach((e=>{e(...t)}))}const h=e=>e();function m(t,o){t instanceof Map&&o instanceof Map&&o.forEach(((e,o)=>t.set(o,e))),t instanceof Set&&o instanceof Set&&o.forEach(t.add,t);for(const s in o){if(!o.hasOwnProperty(s))continue;const n=o[s],i=t[s];a(i)&&a(n)&&t.hasOwnProperty(s)&&!e.isRef(n)&&!e.isReactive(n)?t[s]=m(i,n):t[s]=n}return t}const p=Symbol();const{assign:u}=Object;function g(t,o,n={},l,g,y){let v;const k=u({actions:{}},n),w={deep:!0};let f,T,E,C=[],A=[];const N=l.state.value[t];let S;function b(o){let s;f=T=!1,"function"==typeof o?(o(l.state.value[t]),s={type:i.patchFunction,storeId:t,events:E}):(m(l.state.value[t],o),s={type:i.patchObject,payload:o,storeId:t,events:E});const n=S=Symbol();e.nextTick().then((()=>{S===n&&(f=!0)})),T=!0,d(C,s,l.state.value[t])}y||N||(l.state.value[t]={}),e.ref({});const D=y?function(){const{state:e}=n,t=e?e():{};this.$patch((e=>{u(e,t)}))}:c;function V(e,o){return function(){s(l);const n=Array.from(arguments),a=[],i=[];function c(e){a.push(e)}function r(e){i.push(e)}let h;d(A,{args:n,name:e,store:P,after:c,onError:r});try{h=o.apply(this&&this.$id===t?this:P,n)}catch(m){throw d(i,m),m}return h instanceof Promise?h.then((e=>(d(a,e),e))).catch((e=>(d(i,e),Promise.reject(e)))):(d(a,h),h)}}const x={_p:l,$id:t,$onAction:r.bind(null,A),$patch:b,$reset:D,$subscribe(o,s={}){const n=r(C,o,s.detached,(()=>a())),a=v.run((()=>e.watch((()=>l.state.value[t]),(e=>{("sync"===s.flush?T:f)&&o({storeId:t,type:i.direct,events:E},e)}),u({},w,s))));return n},$dispose:function(){v.stop(),C=[],A=[],l._s.delete(t)}},P=e.reactive(x);l._s.set(t,P);const B=(l._a&&l._a.runWithContext||h)((()=>l._e.run((()=>(v=e.effectScope()).run(o)))));for(const s in B){const o=B[s];if(e.isRef(o)&&(M=o,!e.isRef(M)||!M.effect)||e.isReactive(o))y||(!N||a(I=o)&&I.hasOwnProperty(p)||(e.isRef(o)?o.value=N[s]:m(o,N[s])),l.state.value[t][s]=o);else if("function"==typeof o){const e=V(s,o);B[s]=e,k.actions[s]=o}}var I,M;return u(P,B),u(e.toRaw(P),B),Object.defineProperty(P,"$state",{get:()=>l.state.value[t],set:e=>{b((t=>{u(t,e)}))}}),l._p.forEach((e=>{u(P,v.run((()=>e({store:P,app:l._a,pinia:l,options:k}))))})),N&&y&&n.hydrate&&n.hydrate(P.$state,N),f=!0,T=!0,P}function y(t,a,i){let l,c;const r="function"==typeof a;function d(t,i){const d=e.hasInjectionContext();(t=t||(d?e.inject(n,null):null))&&s(t),(t=o)._s.has(l)||(r?g(l,a,c,t):function(t,o,n,a){const{state:i,actions:l,getters:c}=o,r=n.state.value[t];let d;d=g(t,(function(){r||(n.state.value[t]=i?i():{});const o=e.toRefs(n.state.value[t]);return u(o,l,Object.keys(c||{}).reduce(((o,a)=>(o[a]=e.markRaw(e.computed((()=>{s(n);const e=n._s.get(t);return c[a].call(e,e)}))),o)),{}))}),o,n,0,!0)}(l,c,t));return t._s.get(l)}return"string"==typeof t?(l=t,c=r?i:a):(c=t,l=t.id),d.$id=l,d}const v="fitness_templates",k="fitness_daydata_",w=y("template",{state:()=>({templates:[]}),actions:{load(){const e=uni.getStorageSync(v)||[];this.templates=Array.isArray(e)?e:[]},save(){uni.setStorageSync(v,this.templates)},addTemplate(e){e&&!this.templates.find((t=>t.name===e))&&(this.templates.push({name:e,actions:[],color:"",customColors:[]}),this.save())},removeTemplate(e){this.templates=this.templates.filter((t=>t.name!==e)),this.save()},rename(e,t){if(!t||e===t)return;const o=this.templates.find((t=>t.name===e));o&&(o.name=t);uni.getStorageInfoSync().keys.forEach((o=>{var s;if(!o.startsWith(k))return;const n=uni.getStorageSync(o)||{};(null==(s=n.templates)?void 0:s[e])&&(n.templates[t]=n.templates[e],delete n.templates[e],uni.setStorageSync(o,n))})),this.save()},isUsed:e=>uni.getStorageInfoSync().keys.some((t=>{if(!t.startsWith(k))return!1;const o=uni.getStorageSync(t)||{};return!(!o.templates||!o.templates[e])})),loadTemplateDetail(e){var t;const o=this.templates.find((t=>t.name===e));return{actions:(null==o?void 0:o.actions.slice())||[],color:(null==o?void 0:o.color)||"",customColors:(null==(t=null==o?void 0:o.customColors)?void 0:t.slice())||[]}},addAction(e,t){const o=this.templates.find((t=>t.name===e));o&&t&&!o.actions.includes(t)&&(o.actions.push(t),this.save())},removeAction(e,t){const o=this.templates.find((t=>t.name===e));o&&null!=o.actions[t]&&(o.actions.splice(t,1),this.save())},moveAction(e,t,o){const s=this.templates.find((t=>t.name===e));if(!s)return;const n=s.actions;if(t<0||t>=n.length||o<0||o>=n.length)return;const a=n[t];n[t]=n[o],n[o]=a,this.save()},setColor(e,t){const o=this.templates.find((t=>t.name===e));o&&(o.color=t,this.save())},clearColor(e){const t=this.templates.find((t=>t.name===e));t&&(t.color="",this.save())},addCustomColor(e,t,o){const s=this.templates.find((t=>t.name===e));if(!s)return;s.customColors=s.customColors||[];s.customColors.some((e=>e.value.toLowerCase()===o.toLowerCase()))||(s.customColors.unshift({name:t,value:o}),this.save())},removeCustomColor(e,t){const o=this.templates.find((t=>t.name===e));(null==o?void 0:o.customColors)&&o.customColors[t]&&(o.customColors.splice(t,1),this.save())}}}),f="fitness_actions",T=y("action",{state:()=>({actions:[]}),actions:{load(){const e=uni.getStorageSync(f)||[];this.actions=Array.isArray(e)?e:[]},save(){uni.setStorageSync(f,this.actions)},addAction(e){e&&!this.actions.includes(e)&&(this.actions.push(e),this.save())},removeActionByIndex(e){e<0||e>=this.actions.length||(this.actions.splice(e,1),this.save())},renameAction(e,t){if(!t||e===t)return;const o=this.actions.indexOf(e);-1!==o&&(this.actions.splice(o,1,t),this.save());uni.getStorageInfoSync().keys.forEach((o=>{if(!o.startsWith("fitness_daydata_"))return;const s=uni.getStorageSync(o)||{};s.entries&&Array.isArray(s.entries[e])&&(s.entries[t]=s.entries[e],delete s.entries[e]),s.templates&&Object.values(s.templates).forEach((o=>{o.actionWeights&&null!=o.actionWeights[e]&&(o.actionWeights[t]=o.actionWeights[e],delete o.actionWeights[e]),Array.isArray(o.actionOrder)&&(o.actionOrder=o.actionOrder.map((o=>o===e?t:o)))})),uni.setStorageSync(o,s)}));const s=w();s.load();let n=!1;s.templates.forEach((o=>{const s=o.actions.indexOf(e);-1!==s&&(o.actions.splice(s,1,t),n=!0)})),n&&s.save()}}}),E=(e,t)=>{const o=e.__vccOpts||e;for(const[s,n]of t)o[s]=n;return o};const C=E({data:()=>({darkMode:!1,darkModeClass:"light",curYear:0,curMonth:0,monthDays:[],monthKey:0,touchStartX:0,DAYDATA_PREFIX:"fitness_daydata_",showActionPopup:!1,newActionName:"",pressedActionIndex:-1,longPressTimer:null,longPressThreshold:500,showTemplatePopup:!1,newTemplateName:"",showTemplateActionPopup:!1,newTemplateActions:[],newTemplateColor:"#93d5dc",presetColors:[{name:"Ê∏ÖÊ∞¥Ëìù",value:"#93d5dc"},{name:"ÊùæÁü≥Áªø",value:"#4DB6AC"},{name:"Ëó§ËêùÁ¥´",value:"#8076a3"},{name:"ÂßúÁ∫¢",value:"#eeb8c3"},{name:"ÂÖãËé±Âõ†Ëìù",value:"#002fa7"},{name:"È©¨Â∞îÊñØÁªø",value:"#01847f"},{name:"Áî≥Â∏É‰º¶ÈªÑ",value:"#fbd26a"},{name:"ÊèêÈ¶ôÁ∫¢",value:"#d44848"},{name:"Á≤âÁ∫¢",value:"#f2b9b2"},{name:"ÁéõÁëôÁÅ∞",value:"#cfccc9"},{name:"Ê±âÁôΩÁéâ",value:"#f8f4ed"}],pressedTemplateIndex:-1,thisWeekTotal:0,lastWeekTotal:0,diffText:"0kg",diffClass:"diff-neutral",annivs:[],showAnnivPopup:!1,annivTitleInput:"",annivDateInput:"",editingIndex:null,showAerobicDetail:!1,aerobicDetail:{date:"",name:"",time:0,color:""},showAerobicColorPicker:!1,showRestDetail:!1,restDetail:{date:"",reason:"",color:""},showRestColorPicker:!1}),computed:{actions(){return this.actionStore.actions},templates(){return this.templateStore.templates}},created(){this.actionStore=T(),this.actionStore.load(),this.templateStore=w(),this.templateStore.load()},onShow(){this.actionStore.load(),this.templateStore.load(),this.buildMonthDays(this.curYear,this.curMonth),this.calcWeeklyTotals(),this.loadAnnivs()},onLoad(e){this.actStore=T(),this.actStore.load(),this.actions=this.actStore.actions,this.tplStore=w(),this.tplStore.load()},mounted(){const e=uni.getStorageSync("darkMode");if("auto"===e){const e=uni.getSystemInfoSync().theme||"light";this.darkMode="dark"===e}else this.darkMode=!0===e;this.darkModeClass=this.darkMode?"dark":"light",this.updateNavigationBarStyle(this.darkMode),this.initCalendar(),this.tplStore=w(),this.tplStore.load(),this.templates=this.tplStore.templates},methods:{closeRestDetail(){this.showRestDetail=!1},selectRestColor(e){this.restDetail.color=e;const t=this.DAYDATA_PREFIX+this.restDetail.date,o=uni.getStorageSync(t)||{};o.color=e,uni.setStorageSync(t,o),uni.showToast({title:"Â∑≤‰øùÂ≠òÈ¢úËâ≤",icon:"success"}),this.showRestDetail=!1},isRestDay(e){return!0===(uni.getStorageSync(this.DAYDATA_PREFIX+e)||{}).isRestDay},getRestReason(e){return(uni.getStorageSync(this.DAYDATA_PREFIX+e)||{}).restReason||""},toggleTemplateAction(e){const o=this.newTemplateActions.indexOf(e);-1===o?this.newTemplateActions.push(e):this.newTemplateActions.splice(o,1),t("log","at pages/index/index.vue:497","ÂΩìÂâç newTemplateActions È°∫Â∫è:",this.newTemplateActions)},toggleCheckbox(e){this.$nextTick((()=>{const e=this.$refs.cg.value;this.newTemplateActions=e.slice(),t("log","at pages/index/index.vue:506","ÂêåÊ≠•Âêé newTemplateActions=",this.newTemplateActions)}))},goToHelp(){uni.navigateTo({url:"/pages/help/help"})},goToYearPage(){uni.showLoading({title:"Âä†ËΩΩ‰∏≠‚Ä¶",mask:!0}),uni.navigateTo({url:`/pages/year/year?year=${this.curYear}&month=${this.curMonth}`}),setTimeout((()=>{uni.hideLoading()}),100)},getContrastColor(e){e&&"object"==typeof e&&"value"in e&&(e=e.value);let t=String(e).replace(/^#/,"").trim();3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3>128?"#000000":"#FFFFFF"},goToTemplateDetail(e){this.showTemplatePopup=!1,uni.navigateTo({url:`/pages/templateDetail/templateDetail?template=${encodeURIComponent(e)}`})},getTemplateName(e){const t=uni.getStorageSync(this.DAYDATA_PREFIX+e)||{};if(t.templates&&"object"==typeof t.templates){const e=Object.keys(t.templates);if(e.length>0)return e[e.length-1]}return null},getTotalWeight(e){const t=uni.getStorageSync(this.DAYDATA_PREFIX+e)||{};if(!t.templates||"object"!=typeof t.templates||0===Object.keys(t.templates).length)return 0;let o=0;for(const s in t.templates){const e=t.templates[s];e&&"number"==typeof e.totalWeight&&(o+=e.totalWeight)}return o},toggleDarkMode(){if("auto"===uni.getStorageSync("darkMode"))this.darkMode=!this.darkMode,uni.setStorageSync("darkMode",this.darkMode);else{uni.setStorageSync("darkMode","auto");const e=uni.getSystemInfoSync().theme||"light";this.darkMode="dark"===e}this.darkModeClass=this.darkMode?"dark":"light",this.updateNavigationBarStyle(this.darkMode)},onEmojiTap(){this.animateJump||(this.darkMode=!this.darkMode,uni.setStorageSync("darkMode",this.darkMode),this.darkModeClass=this.darkMode?"dark":"light",this.updateNavigationBarStyle(this.darkMode),this.animateJump=!0)},onAnimationEnd(e){this.animateJump=!1},updateNavigationBarStyle(e){const t=e?"#121212":"#FFFFFF",o=e?"#f7f7f7":"#333333";uni.setNavigationBarColor({frontColor:o,backgroundColor:t,animation:{duration:200,timingFunc:"easeIn"}})},initCalendar(){const e=new Date;this.curYear=e.getFullYear(),this.curMonth=e.getMonth(),this.buildMonthDays(this.curYear,this.curMonth)},buildMonthDays(e,t){const o=new Date(e,t+1,0).getDate(),s=[],n=this.formatDate(new Date),a=new Date(e,t,1).getDay();for(let i=0;i<a;i++)s.push({key:`empty-${e}-${t}-${i}`,day:"",full:"",isToday:!1,isEmpty:!0});for(let i=1;i<=o;i++){const o=new Date(e,t,i),a=this.formatDate(o);s.push({key:`day-${e}-${t}-${i}`,day:i,full:a,isToday:a===n,isEmpty:!1})}this.monthDays=s,this.calcWeeklyTotals()},formatDate(e){const t=e.getFullYear(),o=e.getMonth()+1,s=e.getDate();return t+"-"+(o<10?"0"+o:o)+"-"+(s<10?"0"+s:s)},onTouchStart(e){this.touchStartX=e.changedTouches[0].clientX},onTouchEnd(e){const t=e.changedTouches[0].clientX-this.touchStartX;t>50?this.prevMonth():t<-50&&this.nextMonth()},prevMonth(){let e=this.curYear,t=this.curMonth-1;t<0&&(e-=1,t=11),this.curYear=e,this.curMonth=t,this.monthKey+=1,this.buildMonthDays(e,t)},nextMonth(){let e=this.curYear,t=this.curMonth+1;t>11&&(e+=1,t=0),this.curYear=e,this.curMonth=t,this.monthKey+=1,this.buildMonthDays(e,t)},handleDateClick(e){const t=this.DAYDATA_PREFIX+e,o=uni.getStorageSync(t)||{};if(o.isRestDay){const t=Object.keys(o.templates||{})[0]||"Êú™Â°´ÂÜôÁêÜÁî±",s=o.color||"";return this.restDetail={date:e,reason:t,color:s},this.showRestDetail=!0,void(this.showRestColorPicker=!1)}const s=o.templates?Object.keys(o.templates):[];if(1===s.length){const t=o.templates[s[0]];if(t&&t.totalWeight>0&&(!t.actionWeights||0===Object.keys(t.actionWeights).length))return this.aerobicDetail.date=e,this.aerobicDetail.name=s[0],this.aerobicDetail.time=t.totalWeight,void(this.showAerobicDetail=!0)}uni.navigateTo({url:`/pages/index/day?date=${e}`})},onDateLongPress(e){uni.vibrateShort({type:"light"}),uni.showModal({title:"ÊèêÁ§∫",content:`ÊòØÂê¶Ê∏ÖÁ©∫ ${e} ÁöÑÊâÄÊúâËÆ∞ÂΩïÔºü`,success:t=>{t.confirm&&(uni.removeStorageSync(this.DAYDATA_PREFIX+e),uni.showToast({title:"Â∑≤Ê∏ÖÁ©∫",icon:"none"}),this.buildMonthDays(this.curYear,this.curMonth),this.calcWeeklyTotals())}})},hasDataForDate(e){return!!uni.getStorageSync(this.DAYDATA_PREFIX+e)},getWeekRange(e){const t=e.getDay(),o=0===t?-6:1-t,s=new Date(e);s.setDate(e.getDate()+o);const n=new Date(s);return n.setDate(s.getDate()+6),[this.formatDate(s),this.formatDate(n)]},calcTotalInRange(e,t){const o=new Date(e),s=new Date(t);let n=0;for(let a=new Date(o);a<=s;a.setDate(a.getDate()+1)){const e=this.formatDate(a),t=(uni.getStorageSync(this.DAYDATA_PREFIX+e)||{}).templates||{};for(const o in t){const e=t[o],s=e.actionWeights&&0===Object.keys(e.actionWeights).length;e.isAerobic||s||"number"==typeof e.totalWeight&&(n+=e.totalWeight)}}return n},calcWeeklyTotals(){const e=new Date,[t,o]=this.getWeekRange(e);this.thisWeekTotal=this.calcTotalInRange(t,o);const s=new Date(t),n=new Date(s);n.setDate(s.getDate()-7);const a=this.formatDate(n),i=new Date(n);i.setDate(n.getDate()+6);const l=this.formatDate(i);this.lastWeekTotal=this.calcTotalInRange(a,l);const c=this.thisWeekTotal-this.lastWeekTotal;c>0?(this.diffText=`+${c}kg`,this.diffClass="diff-positive"):c<0?(this.diffText=`${c}kg`,this.diffClass="diff-negative"):(this.diffText="0kg",this.diffClass="diff-neutral")},addAction(){const e=this.newActionName.trim();if(e){if(this.actStore.actions.includes(e))return uni.showToast({title:"Âä®‰ΩúÂ∑≤Â≠òÂú®",icon:"none"}),void(this.newActionName="");this.actStore.addAction(e),this.newActionName=""}else uni.showToast({title:"ËØ∑ËæìÂÖ•Âä®‰ΩúÂêçÁß∞",icon:"none"})},handleTagTouchStart(e){this.pressedActionIndex=e,clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout((()=>this.handleTagLongPress(e)),this.longPressThreshold)},handleTagTouchMove(){clearTimeout(this.longPressTimer)},handleTagTouchEnd(){clearTimeout(this.longPressTimer),this.pressedActionIndex=-1},handleTagLongPress(e){const t=this.actionStore.actions[e];uni.vibrateShort({type:"light"}),uni.showModal({title:"Âà†Èô§Âä®‰Ωú",content:`Á°ÆÂÆöË¶ÅÂà†Èô§„Äå${t}„ÄçÂêóÔºü`,success:t=>{t.confirm&&this.actionStore.removeActionByIndex(e)}}),this.pressedActionIndex=-1,clearTimeout(this.longPressTimer)},goToActionHistory(e){this.showActionPopup=!1,uni.navigateTo({url:`/pages/actionHistory/actionHistory?action=${encodeURIComponent(e)}`})},prepareNewTemplate(){const e=this.newTemplateName.trim();if(e){if(this.tplStore.templates.some((t=>t.name===e)))return uni.showToast({title:"Ê®°ÊùøÂ∑≤Â≠òÂú®",icon:"none"}),void(this.newTemplateName="");this.tplStore.addTemplate(e),this.templates=this.tplStore.templates,this.showTemplatePopup=!1,this.showTemplateActionPopup=!0,this.newTemplateActions=[],this.newTemplateColor=this.presetColors[0].value}else uni.showToast({title:"ËØ∑ËæìÂÖ•Ê®°ÊùøÂêçÁß∞",icon:"none"})},cancelNewTemplate(){this.showTemplateActionPopup=!1,this.showTemplatePopup=!0,this.newTemplateName="",this.newTemplateActions=[],this.newTemplateColor=this.presetColors[0].value},addTemplate(){const e=this.newTemplateName.trim(),t=this.tplStore.templates.find((t=>t.name===e));t&&(t.actions=[...this.newTemplateActions],t.color=this.newTemplateColor,this.tplStore.save(),this.templates=this.tplStore.templates,uni.showToast({title:"Ê®°ÊùøÂàõÂª∫ÊàêÂäü",icon:"success"}),this.showTemplateActionPopup=!1,this.newTemplateName="",this.newTemplateActions=[])},goToTemplateDetail(e){this.showTemplatePopup=!1,uni.navigateTo({url:`/pages/templateDetail/templateDetail?template=${encodeURIComponent(e)}`})},handleTemplateTouchStart(e){this.pressedTemplateIndex=e,clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout((()=>this.handleTemplateLongPress(e)),this.longPressThreshold)},handleTemplateTouchMove(){clearTimeout(this.longPressTimer)},handleTemplateTouchEnd(){clearTimeout(this.longPressTimer),this.pressedTemplateIndex=-1},handleTemplateLongPress(e){const t=this.templates[e];this.templateStore.isUsed(t.name)?uni.showToast({title:"Ê®°ÊùøÂ∑≤Ë¢´‰ΩøÁî®ÔºåÊó†Ê≥ïÂà†Èô§",icon:"none"}):(uni.vibrateShort({type:"light"}),uni.showModal({title:"Âà†Èô§Ê®°Êùø",content:`Á°ÆÂÆöÂà†Èô§„Äå${t.name}„ÄçÂêóÔºü`,success:e=>{e.confirm&&this.templateStore.removeTemplate(t.name)}}),this.pressedTemplateIndex=-1,clearTimeout(this.longPressTimer))},updateAnnivDaysFor(e){if(!e)return"0 Â§©";let t=e.trim();t.includes("Âπ¥")&&t.includes("Êúà")&&t.includes("Êó•")&&(t=t.replace("Âπ¥","/").replace("Êúà","/").replace("Êó•",""));const o=new Date(t.replace(/-/g,"/"));if(isNaN(o.getTime()))return"0 Â§©";const s=(new Date).setHours(0,0,0,0)-o.setHours(0,0,0,0);return`${Math.floor(s/864e5)+1} Â§©`},loadAnnivs(){const e=uni.getStorageSync("annivs")||"[]";try{this.annivs=JSON.parse(e)}catch(t){this.annivs=[]}this.annivs.forEach((e=>{e.daysText=this.updateAnnivDaysFor(e.date)}))},saveAnnivs(){uni.setStorageSync("annivs",JSON.stringify(this.annivs))},openAnnivPopup(e){if(null===e)this.editingIndex=null,this.annivTitleInput="",this.annivDateInput="";else{this.editingIndex=e;const t=this.annivs[e];this.annivTitleInput=t.title,this.annivDateInput=t.date}this.showAnnivPopup=!0},saveAnniv(){const e=this.annivTitleInput.trim(),t=this.annivDateInput;if(!e||!t)return void uni.showToast({title:"ËØ∑Â°´ÂÜôÂÆåÊï¥‰ø°ÊÅØ",icon:"none"});const o=this.updateAnnivDaysFor(t);null===this.editingIndex?this.annivs.push({title:e,date:t,daysText:o}):this.annivs[this.editingIndex]={title:e,date:t,daysText:o},this.saveAnnivs(),this.showAnnivPopup=!1},removeAnniv(e){uni.showModal({title:"Á°ÆËÆ§Âà†Èô§",content:`Âà†Èô§„Äå${this.annivs[e].title}„ÄçÂêóÔºü`,success:t=>{t.confirm&&(this.annivs.splice(e,1),this.saveAnnivs())}})},onAnnivLongPress(e){uni.vibrateShort({type:"light"}),uni.showModal({title:"Á°ÆËÆ§Âà†Èô§",content:`Á°ÆÂÆöË¶ÅÂà†Èô§„Äå${this.annivs[e].title}„ÄçÂêóÔºü`,success:t=>{t.confirm&&(this.annivs.splice(e,1),this.saveAnnivs())}})},goToActionHistory(e){this.showActionPopup=!1,uni.navigateTo({url:`/pages/actionHistory/actionHistory?action=${encodeURIComponent(e)}`})},getTemplateColor(e){const t=uni.getStorageSync(this.DAYDATA_PREFIX+e)||{};if(t.isRestDay&&t.color)return t.color;if(t.templates){const e=Object.keys(t.templates);if(e.length){const o=e[e.length-1],s=t.templates[o];if(s.color)return s.color}}const o=this.getTemplateName(e);if(!o)return"";const s=this.templates.find((e=>e.name===o));return s?s.color:""},getCellStyle(e){const t=this.formatDate(new Date),o=e?this.getTemplateColor(e):"";return e===t&&o?{backgroundColor:o,boxShadow:"inset 0 0 10px 5px #287eff"}:e===t?{backgroundColor:"#287eff"}:o?{backgroundColor:o}:{}},openAerobicDetail(){const e=uni.getStorageSync(this.DAYDATA_PREFIX+this.date)||{},t=Object.keys(e.templates||{});1===t.length&&0===Object.keys(e.templates[t[0]].actionWeights).length&&(this.aerobicDetail.name=t[0],this.aerobicDetail.time=e.templates[t[0]].totalWeight,this.showAerobicDetail=!0)},closeAerobicDetail(){this.showAerobicDetail=!1,this.showAerobicColorPicker=!1},selectAerobicColor(e){const t=this.DAYDATA_PREFIX+this.aerobicDetail.date,o={...uni.getStorageSync(t)||{}},s=o.templates[this.aerobicDetail.name]||{};s.color=e,o.templates[this.aerobicDetail.name]=s,uni.setStorageSync(t,o),this.aerobicDetail.color=e,this.showAerobicColorPicker=!1,this.showAerobicDetail=!1,uni.showToast({title:"Â∑≤‰øùÂ≠òÈ¢úËâ≤",icon:"success"}),this.buildMonthDays(this.curYear,this.curMonth)},isAerobicDay(e){const t=(uni.getStorageSync(this.DAYDATA_PREFIX+e)||{}).templates||{},o=Object.keys(t);if(1!==o.length)return!1;const s=t[o[0]],n=s.actionWeights&&0===Object.keys(s.actionWeights).length;return!0===s.isAerobic||n}}},[["render",function(t,o,s,n,a,i){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["container",a.darkModeClass])},[e.createElementVNode("view",{class:"calendar-container",onTouchstart:o[1]||(o[1]=(...e)=>i.onTouchStart&&i.onTouchStart(...e)),onTouchend:o[2]||(o[2]=(...e)=>i.onTouchEnd&&i.onTouchEnd(...e))},[(e.openBlock(),e.createElementBlock("view",{key:a.monthKey},[e.createElementVNode("view",{class:"calendar-header"},[e.createElementVNode("text",{class:"month-title",onClick:o[0]||(o[0]=(...e)=>i.goToYearPage&&i.goToYearPage(...e))},e.toDisplayString(a.curYear)+"/"+e.toDisplayString(a.curMonth+1),1)]),e.createElementVNode("view",{class:"weekday-row"},[e.createElementVNode("text",{class:"weekday"},"Êó•"),e.createElementVNode("text",{class:"weekday"},"‰∏Ä"),e.createElementVNode("text",{class:"weekday"},"‰∫å"),e.createElementVNode("text",{class:"weekday"},"‰∏â"),e.createElementVNode("text",{class:"weekday"},"Âõõ"),e.createElementVNode("text",{class:"weekday"},"‰∫î"),e.createElementVNode("text",{class:"weekday"},"ÂÖ≠")]),e.createElementVNode("view",{class:"calendar-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.monthDays,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.key,class:e.normalizeClass(["calendar-cell",{today:t.isToday&&!i.getTemplateColor(t.full),"today-has-template":t.isToday&&i.getTemplateColor(t.full)}]),style:e.normalizeStyle(i.getCellStyle(t.full)),onClick:e=>!t.isEmpty&&i.handleDateClick(t.full),onLongpress:e=>!t.isEmpty&&i.onDateLongPress(t.full)},[e.createElementVNode("view",{class:"cell-content"},[t.isEmpty?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[],64)):i.getTemplateColor(t.full)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[i.getTotalWeight(t.full)>0?(e.openBlock(),e.createElementBlock("text",{key:0,class:"weight-text",style:e.normalizeStyle({color:i.getContrastColor(i.getTemplateColor(t.full))})},e.toDisplayString(i.getTotalWeight(t.full))+e.toDisplayString(i.isAerobicDay(t.full)?"min":""),5)):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"cell-text",style:e.normalizeStyle({color:i.getContrastColor(i.getTemplateColor(t.full))})},e.toDisplayString(t.day),5),e.createElementVNode("text",{class:"template-name",style:e.normalizeStyle({color:i.getContrastColor(i.getTemplateColor(t.full))})},e.toDisplayString(i.getTemplateName(t.full)),5)],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[i.getTotalWeight(t.full)>0?(e.openBlock(),e.createElementBlock("text",{key:0,class:"weight-text",style:e.normalizeStyle({color:i.getContrastColor(i.getTemplateColor(t.full))})},e.toDisplayString(i.getTotalWeight(t.full))+e.toDisplayString(i.isAerobicDay(t.full)?"min":""),5)):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"cell-text"},e.toDisplayString(t.day),1),i.getTemplateName(t.full)?(e.openBlock(),e.createElementBlock("text",{key:1,class:"template-name"},e.toDisplayString(i.getTemplateName(t.full)),1)):e.createCommentVNode("",!0)],64))])],46,["onClick","onLongpress"])))),128))])]))],32),e.createElementVNode("view",{class:"bottom-container"},[e.createElementVNode("view",{class:"bottom-left"},[e.createElementVNode("view",{class:"custom-switch",onClick:o[3]||(o[3]=(...e)=>i.toggleDarkMode&&i.toggleDarkMode(...e))},[e.createElementVNode("view",{class:e.normalizeClass(["switch-track",a.darkMode?"track-checked":""])},null,2),e.createElementVNode("view",{class:e.normalizeClass(["switch-thumb",a.darkMode?"thumb-checked":""])},[e.createElementVNode("text",{class:e.normalizeClass(["emoji-thumb",{"thumb-rotated":a.darkMode}])},e.toDisplayString(a.darkMode?"üåô":"‚òÄÔ∏è"),3)],2)]),e.createElementVNode("text",{class:"round-btn help-btn",onClick:o[4]||(o[4]=(...e)=>i.goToHelp&&i.goToHelp(...e))},"Â§áÂøòÂΩï")]),e.createElementVNode("view",{class:"bottom-center"},[e.createElementVNode("view",{class:"weight-info"},[e.createElementVNode("text",{class:"weight-line"},"Êú¨Âë®Ôºö"+e.toDisplayString(a.thisWeekTotal)+"kg",1),e.createElementVNode("text",{class:"weight-line"},"‰∏äÂë®Ôºö"+e.toDisplayString(a.lastWeekTotal)+"kg",1)])]),e.createElementVNode("view",{class:"bottom-right"},[e.createElementVNode("text",{class:"round-btn",onClick:o[5]||(o[5]=e=>a.showTemplatePopup=!0)},"Ê®°Êùø"),e.createElementVNode("text",{class:"round-btn",onClick:o[6]||(o[6]=e=>a.showActionPopup=!0)},"Âä®‰Ωú")])]),e.createElementVNode("view",{class:"anniv-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.annivs,((t,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,class:e.normalizeClass(["anniv-item",a.darkModeClass]),onClick:e=>i.openAnnivPopup(o),onLongpress:e=>i.onAnnivLongPress(o)},[e.createElementVNode("view",{class:"anniv-header"},[e.createElementVNode("text",null,e.toDisplayString(t.title)+" ¬∑ "+e.toDisplayString(t.daysText),1)]),e.createElementVNode("view",{class:"anniv-sub"},"Á∫™ÂøµÊó• | "+e.toDisplayString(t.date),1)],42,["onClick","onLongpress"])))),128)),e.createElementVNode("view",{class:"anniv-item add-anniv",onClick:o[7]||(o[7]=e=>i.openAnnivPopup(null))},[e.createElementVNode("text",{class:"anniv-placeholder"},"Ôºã Ê∑ªÂä†Á∫™ÂøµÊó•")])]),a.showActionPopup?(e.openBlock(),e.createElementBlock("view",{key:0,class:"popup-overlay",onClick:o[15]||(o[15]=e.withModifiers((e=>a.showActionPopup=!1),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[8]||(o[8]=e=>a.showActionPopup=!1)}),e.createElementVNode("view",{class:"popup-panel slide-up",onClick:o[14]||(o[14]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"panel-header"},[e.createElementVNode("text",{class:"panel-title"},"ÁÆ°ÁêÜÂä®‰Ωú"),e.createElementVNode("text",{class:"close-btn",onClick:o[9]||(o[9]=e=>a.showActionPopup=!1)},"√ó")]),e.createElementVNode("view",{class:"panel-body"},[e.createElementVNode("view",{class:"input-row"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[10]||(o[10]=e=>a.newActionName=e),placeholder:"ËæìÂÖ•Êñ∞Âä®‰ΩúÂêçÁß∞",class:"action-input"},null,512),[[e.vModelText,a.newActionName]]),e.createElementVNode("text",{class:"btn-add",onClick:o[11]||(o[11]=(...e)=>i.addAction&&i.addAction(...e))},"Ê∑ªÂä†")]),e.createElementVNode("scroll-view",{class:"tag-scroll","scroll-y":"true","show-scrollbar":"false",style:{maxHeight:"30vh"}},[e.createElementVNode("view",{class:"tag-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.actions,((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:s,class:"tag",onTouchstart:e=>i.handleTagTouchStart(s),onTouchmove:o[12]||(o[12]=(...e)=>i.handleTagTouchMove&&i.handleTagTouchMove(...e)),onTouchend:o[13]||(o[13]=(...e)=>i.handleTagTouchEnd&&i.handleTagTouchEnd(...e)),onClick:e=>i.goToActionHistory(t)},[e.createElementVNode("text",{class:"tag-text-center"},e.toDisplayString(t),1)],40,["onTouchstart","onClick"])))),128))])])])])])):e.createCommentVNode("",!0),a.showTemplatePopup?(e.openBlock(),e.createElementBlock("view",{key:1,class:"popup-overlay",onClick:o[23]||(o[23]=e.withModifiers((e=>a.showTemplatePopup=!1),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[16]||(o[16]=e=>a.showTemplatePopup=!1)}),e.createElementVNode("view",{class:"popup-panel slide-up",onClick:o[22]||(o[22]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"panel-header"},[e.createElementVNode("text",{class:"panel-title"},"Âø´ÈÄüÂàõÂª∫Ê®°Êùø"),e.createElementVNode("text",{class:"close-btn",onClick:o[17]||(o[17]=e=>a.showTemplatePopup=!1)},"√ó")]),e.createElementVNode("view",{class:"panel-body"},[e.createElementVNode("view",{class:"input-row"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[18]||(o[18]=e=>a.newTemplateName=e),placeholder:"ËæìÂÖ•Ê®°ÊùøÂêçÁß∞",class:"action-input"},null,512),[[e.vModelText,a.newTemplateName]]),e.createElementVNode("text",{class:"btn-add",onClick:o[19]||(o[19]=(...e)=>i.prepareNewTemplate&&i.prepareNewTemplate(...e))},"Á°ÆËÆ§")]),e.createElementVNode("scroll-view",{class:"template-tag-scroll","scroll-y":"true","show-scrollbar":"false",style:{maxHeight:"30vh"}},[e.createElementVNode("view",{class:"template-tag-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.templates.filter((e=>!e.isAerobic)),((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:s,class:"template-tag",style:e.normalizeStyle({backgroundColor:t.color}),onTouchstart:e=>i.handleTemplateTouchStart(s),onTouchmove:o[20]||(o[20]=(...e)=>i.handleTagTouchMove&&i.handleTagTouchMove(...e)),onTouchend:o[21]||(o[21]=(...e)=>i.handleTemplateTouchEnd&&i.handleTemplateTouchEnd(...e)),onClick:e=>i.goToTemplateDetail(t.name)},[e.createElementVNode("text",{class:"tag-text-center",style:e.normalizeStyle({color:i.getContrastColor(t.color)})},e.toDisplayString(t.name),5)],44,["onTouchstart","onClick"])))),128)),0===i.templates.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"no-data"},[e.createElementVNode("text",null,"ÊöÇÊó†Ê®°ÊùøÔºåÂÖàÊ∑ªÂä†‰∏Ä‰∏™Âêß~")])):e.createCommentVNode("",!0)])])])])])):e.createCommentVNode("",!0),a.showTemplateActionPopup?(e.openBlock(),e.createElementBlock("view",{key:2,class:"popup-overlay",onClick:o[29]||(o[29]=e.withModifiers(((...e)=>i.cancelNewTemplate&&i.cancelNewTemplate(...e)),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[24]||(o[24]=(...e)=>i.cancelNewTemplate&&i.cancelNewTemplate(...e))}),e.createElementVNode("view",{class:"popup-panel slide-up",onClick:o[28]||(o[28]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"panel-header"},[e.createElementVNode("text",{class:"panel-title"},"‰∏∫Ê®°Êùø ‚Äú"+e.toDisplayString(a.newTemplateName)+"‚Äù ÈÄâÊã©Âä®‰Ωú",1),e.createElementVNode("text",{class:"close-btn",onClick:o[25]||(o[25]=(...e)=>i.cancelNewTemplate&&i.cancelNewTemplate(...e))},"√ó")]),e.createElementVNode("scroll-view",{class:"template-tag-scroll","scroll-y":"true","show-scrollbar":"false",style:{maxHeight:"30vh"}},[e.createElementVNode("view",{class:"panel-body"},[e.createElementVNode("scroll-view",{class:"action-select-list","scroll-y":""},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.actions,(t=>(e.openBlock(),e.createElementBlock("view",{key:t,class:"checkbox-row",onClick:e=>i.toggleTemplateAction(t)},[e.createElementVNode("text",{class:"checkbox-icon"},e.toDisplayString(a.newTemplateActions.includes(t)?"‚úîÔ∏è":"‚óªÔ∏è"),1),e.createElementVNode("text",{class:"checkbox-label"},e.toDisplayString(t),1)],8,["onClick"])))),128)),0===i.actions.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"no-data"},[e.createElementVNode("text",null,"ÊöÇÊó†Âä®‰ΩúÔºåËØ∑ÂÖàÂú®‚ÄúÂä®‰Ωú‚ÄùÂºπÁ™óÈáåÊ∑ªÂä†")])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"color-picker-row"},[e.createElementVNode("text",null,"ÈÄâÊã©Ê®°ÊùøÈ¢úËâ≤Ôºö"),e.createElementVNode("view",{class:"color-options"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.presetColors,((t,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,class:"color-option-item",onClick:e=>a.newTemplateColor=t.value},[e.createElementVNode("view",{class:"color-circle",style:e.normalizeStyle({backgroundColor:t.value})},[a.newTemplateColor===t.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"color-selected"})):e.createCommentVNode("",!0)],4),e.createElementVNode("text",{class:"color-name"},e.toDisplayString(t.name),1)],8,["onClick"])))),128))])])])]),e.createElementVNode("view",{class:"panel-footer btn-row"},[e.createElementVNode("text",{class:"btn-return",onClick:o[26]||(o[26]=(...e)=>i.cancelNewTemplate&&i.cancelNewTemplate(...e))},"ËøîÂõû"),e.createElementVNode("text",{class:"btn-confirm",onClick:o[27]||(o[27]=(...e)=>i.addTemplate&&i.addTemplate(...e))},"Ê∑ªÂä†")])])])):e.createCommentVNode("",!0),a.showAnnivPopup?(e.openBlock(),e.createElementBlock("view",{key:3,class:"popup-overlay",onClick:o[36]||(o[36]=e.withModifiers((e=>a.showAnnivPopup=!1),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[30]||(o[30]=e=>a.showAnnivPopup=!1)}),e.createElementVNode("view",{class:"modal-panel fade-in",onClick:o[35]||(o[35]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(null===a.editingIndex?"Êñ∞Â¢ûÁ∫™ÂøµÊó•":"ÁºñËæëÁ∫™ÂøµÊó•"),1),e.createElementVNode("text",{class:"close-icon",onClick:o[31]||(o[31]=e=>a.showAnnivPopup=!1)},"√ó")]),e.createElementVNode("view",{class:"modal-body"},[e.createElementVNode("view",{class:"input-row"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[32]||(o[32]=e=>a.annivTitleInput=e),placeholder:"Á∫™ÂøµÂÜÖÂÆπ",class:"action-input"},null,512),[[e.vModelText,a.annivTitleInput]])]),e.createElementVNode("view",{class:"input-row"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[33]||(o[33]=e=>a.annivDateInput=e),placeholder:"Êó•Êúü",type:"date",class:"action-input"},null,512),[[e.vModelText,a.annivDateInput]])])]),e.createElementVNode("view",{class:"modal-footer btn-row"},[e.createElementVNode("text",{class:"btn-confirm",onClick:o[34]||(o[34]=(...e)=>i.saveAnniv&&i.saveAnniv(...e))},"Á°ÆËÆ§")])])])):e.createCommentVNode("",!0),a.showAerobicDetail?(e.openBlock(),e.createElementBlock("view",{key:4,class:"popup-overlay",onClick:o[40]||(o[40]=e.withModifiers(((...e)=>i.closeAerobicDetail&&i.closeAerobicDetail(...e)),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[37]||(o[37]=(...e)=>i.closeAerobicDetail&&i.closeAerobicDetail(...e))}),e.createElementVNode("view",{class:"modal-panel fade-in"},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"ÊúâÊ∞ß"),e.createElementVNode("text",{class:"close-icon",onClick:o[38]||(o[38]=(...e)=>i.closeAerobicDetail&&i.closeAerobicDetail(...e))},"√ó")]),e.createElementVNode("view",{class:"modal-body"},[e.createElementVNode("text",null,"Á±ªÂûãÔºö"+e.toDisplayString(a.aerobicDetail.name),1),e.createElementVNode("text",null,"Êó∂ÈïøÔºö"+e.toDisplayString(a.aerobicDetail.time)+" ÂàÜÈíü",1),e.createElementVNode("text",{class:"btn-set-color",onClick:o[39]||(o[39]=e=>a.showAerobicColorPicker=!a.showAerobicColorPicker)},e.toDisplayString(a.showAerobicColorPicker?"ÂèñÊ∂àËÆæÁΩÆÈ¢úËâ≤":"ËÆæÁΩÆÈ¢úËâ≤"),1),e.createElementVNode("view",{class:"aerobic-color-picker",style:e.normalizeStyle({display:a.showAerobicColorPicker?"flex":"none"})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.presetColors,((t,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,class:"color-option-item",onClick:e=>i.selectAerobicColor(t.value)},[e.createElementVNode("view",{class:"color-circle",style:e.normalizeStyle({backgroundColor:t.value})},[a.aerobicDetail.color===t.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"color-selected"})):e.createCommentVNode("",!0)],4),e.createElementVNode("text",{class:"color-name"},e.toDisplayString(t.name),1)],8,["onClick"])))),128))],4)])])])):e.createCommentVNode("",!0),a.showRestDetail?(e.openBlock(),e.createElementBlock("view",{key:5,class:"popup-overlay",onClick:o[44]||(o[44]=e.withModifiers(((...e)=>i.closeRestDetail&&i.closeRestDetail(...e)),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[41]||(o[41]=(...e)=>i.closeRestDetail&&i.closeRestDetail(...e))}),e.createElementVNode("view",{class:"modal-panel fade-in"},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"‰ºëÊÅØ"),e.createElementVNode("text",{class:"close-icon",onClick:o[42]||(o[42]=(...e)=>i.closeRestDetail&&i.closeRestDetail(...e))},"√ó")]),e.createElementVNode("view",{class:"modal-body"},[e.createElementVNode("text",null,"ÁêÜÁî±Ôºö"+e.toDisplayString(a.restDetail.reason),1),e.createElementVNode("text",{class:"btn-set-color",onClick:o[43]||(o[43]=e=>a.showRestColorPicker=!a.showRestColorPicker)},e.toDisplayString(a.showRestColorPicker?"ÂèñÊ∂àËÆæÁΩÆÈ¢úËâ≤":"ËÆæÁΩÆÈ¢úËâ≤"),1),e.createElementVNode("view",{class:"aerobic-color-picker",style:e.normalizeStyle({display:a.showRestColorPicker?"flex":"none"})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.presetColors,((t,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,class:"color-option-item",onClick:e=>i.selectRestColor(t.value)},[e.createElementVNode("view",{class:"color-circle",style:e.normalizeStyle({backgroundColor:t.value})},[a.restDetail.color===t.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"color-selected"})):e.createCommentVNode("",!0)],4),e.createElementVNode("text",{class:"color-name"},e.toDisplayString(t.name),1)],8,["onClick"])))),128))],4)])])])):e.createCommentVNode("",!0)],2)}],["__scopeId","data-v-c03f7815"]]);const A=E({data:()=>({date:"",darkMode:!1,darkModeClass:"light",ACTIONS_KEY:"fitness_actions",TEMPLATES_KEY:"fitness_templates",DAYDATA_PREFIX:"fitness_daydata_",templates:[],showChooseTpl:!0,chosenTplIdx:null,chosenTplName:"",chosenTplColor:"",chosenActions:[],actionInputs:[],diffs:[],actionEntries:[],availableActions:[],showAddActionPopup:!1,selectedActionIdx:null,longPressTimer:null,longPressThreshold:500,pressedEntry:{actionIdx:-1,entryIdx:-1},showTimerPopup:!1,timerDuration:60,remaining:60,canvasCtx:null,timerInterval:null,arcTime:270,angle:0,endTimestamp:0,notified:!1,audioCtx:null,showAerobicPopup:!1,aerobicName:"",aerobicTime:null,AEROBIC_COLOR:"#01847f",showRestPopup:!1,restReason:"",commonReasons:["‰ºëÊÅØÊó•","Êúâ‰∫ã","ÊúàÁªè","Âß®Â¶à","ÁîüÁóÖ","Âèó‰º§"],isRestDay:!1,restReasonStored:"",isSearching:!1,searchKeyword:"",filteredActions:[],selectedActionIdx:null}),computed:{displayTime(){if(this.remaining>=60){const e=Math.floor(this.remaining/60),t=this.remaining%60;return`${e}:${t<10?"0"+t:t}`}return String(this.remaining)}},created(){const e=uni.createInnerAudioContext();e.src="/static/notification.mp3",e.loop=!1,this.audioCtx=e},onLoad(e){if(e.date)this.date=e.date;else{const e=new Date;this.date=this.formatDate(e),t("warn","at pages/index/day.vue:254",`[Debug] onLoad Ê≤°‰º† dateÔºåÈªòËÆ§Áî®‰ªäÂ§© = ${this.date}`)}},mounted(){const e=uni.getStorageSync("darkMode");if("auto"===e){const e=uni.getSystemInfoSync().theme||"light";this.darkMode="dark"===e}else this.darkMode=!0===e;this.darkModeClass=this.darkMode?"dark":"light",this.updateNavigationBarStyle(this.darkMode),uni.setNavigationBarTitle({title:this.date.replace(/-/g,"/")});const t=uni.getStorageSync(this.TEMPLATES_KEY);this.templates=Array.isArray(t)?t:[];const o=this.DAYDATA_PREFIX+this.date,s=uni.getStorageSync(o)||{},n=s&&"object"==typeof s?s:{templates:{},actions:{},entries:{}},a=Object.keys(n.templates);if(a.length>0){const e=a[a.length-1],t=this.templates.findIndex((t=>t.name===e));if(-1!==t){this.chosenTplIdx=t,this.chosenTplName=e,this.chosenTplColor=this.templates[t].color;const o=this.templates[t].actions,s=n.templates[e]||{},a=Object.keys(s.actionWeights||{}),i=Array.from(new Set([...o,...a])),l=Array.isArray(s.actionOrder)?s.actionOrder:[];return this.chosenActions=l.length?l.filter((e=>i.includes(e))):i,this.actionInputs=this.chosenActions.map((()=>({reps:"",weight:""}))),this.diffs=this.chosenActions.map((()=>null)),this.actionEntries=this.chosenActions.map((e=>{const t=n.entries[e];return Array.isArray(t)?[...t]:[]})),this.showChooseTpl=!1,void this.$nextTick(this.calcAllDiffs)}}const i=uni.getStorageSync(this.ACTIONS_KEY)||[];this.availableActions=Array.isArray(i)?i:[],this.filteredActions=this.availableActions.slice()},methods:{openRestPopup(){this.showChooseTpl=!1,this.showRestPopup=!0,this.restReason=""},closeRestPopup(){this.showRestPopup=!1,this.showChooseTpl=!0},saveRestDay(){if(!this.restReason.trim())return void uni.showToast({title:"ËØ∑ËæìÂÖ•ÁêÜÁî±",icon:"none"});const e=this.DAYDATA_PREFIX+this.date,t={...uni.getStorageSync(e)||{}};t.isRestDay=!0,t.templates={[this.restReason]:{totalWeight:0,actionWeights:{}}},uni.setStorageSync(e,t),uni.showToast({title:"Â∑≤Ê†áËÆ∞‰ºëÊÅØÊó•",icon:"success"}),this.closeRestPopup(),this.showChooseTpl=!1},moveAction(e,o){const s=e+o;if(s<0||s>=this.chosenActions.length)return;const n=t=>{const o=t[e];this.$set(t,e,t[s]),this.$set(t,s,o)};n(this.chosenActions),n(this.actionInputs),n(this.actionEntries),n(this.diffs),this.persistOrder();const a=this.DAYDATA_PREFIX+this.date;t("log","at pages/index/day.vue:390","[After move] templates in storage:",uni.getStorageSync(a).templates)},goHistory(e){const t=this.chosenActions[e];uni.navigateTo({url:`../actionHistory/actionHistory?action=${encodeURIComponent(t)}`})},onDragEnd({oldIndex:e,newIndex:t}){const o=o=>{const s=o.splice(e,1)[0];o.splice(t,0,s)};o(this.actionInputs),o(this.actionEntries),o(this.diffs),this.persistOrder()},onDragMove:e=>!0,confirmEntry(e){const t=Number(this.actionInputs[e].reps),o=Number(this.actionInputs[e].weight);if(!t||!o)return void uni.showToast({title:"Ê¨°Êï∞ÂíåÈáçÈáèÈÉΩË¶ÅËæìÂÖ•",icon:"none"});const s=t*o,n=`${t}√ó${o}`;this.actionEntries[e].push({input:n,total:s});const a=this.DAYDATA_PREFIX+this.date,i={templates:{},actions:{},entries:{},...uni.getStorageSync(a)||{}};i.entries[this.chosenActions[e]]=this.actionEntries[e],i.actions[this.chosenActions[e]]=this.actionEntries[e].reduce(((e,t)=>e+t.total),0);const l={};this.chosenActions.forEach((e=>{l[e]=i.actions[e]||0})),i.templates[this.chosenTplName]={totalWeight:Object.values(l).reduce(((e,t)=>e+t),0),actionWeights:l,actionOrder:[...this.chosenActions]},uni.setStorageSync(a,i),this.persistOrder(),this.$set(this.actionInputs,e,{reps:"",weight:""}),this.calcAllDiffs()},getTotalWeight(e){return this.actionEntries[e].reduce(((e,t)=>e+t.total),0)},getContrastColor(e){e&&"object"==typeof e&&"value"in e&&(e=e.value);let t=String(e).replace(/^#/,"").trim();if(!/^[0-9A-Fa-f]{3}$/.test(t)&&!/^[0-9A-Fa-f]{6}$/.test(t))return"#000000";3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3>128?"#000000":"#FFFFFF"},toggleDarkMode(){if("auto"===uni.getStorageSync("darkMode"))this.darkMode=!this.darkMode,uni.setStorageSync("darkMode",this.darkMode);else{uni.setStorageSync("darkMode","auto");const e=uni.getSystemInfoSync().theme||"light";this.darkMode="dark"===e}this.darkModeClass=this.darkMode?"dark":"light",this.updateNavigationBarStyle(this.darkMode)},updateNavigationBarStyle(e){const t=e?"#121212":"#f5f5f5",o=e?"#f7f7f7":"#333333";uni.setNavigationBarColor({frontColor:o,backgroundColor:t,animation:{duration:200,timingFunc:"easeIn"}})},closeChooseTpl(){this.showChooseTpl=!1},chooseTemplate(e){this.chosenTplIdx=e;const t=this.templates[e];this.chosenTplName=t.name,this.chosenTplColor=t.color;const o=this.DAYDATA_PREFIX+this.date,s=uni.getStorageSync(o)||{},n=(s&&"object"==typeof s?s:{templates:{},actions:{},entries:{}}).templates[t.name]||{},a=t.actions.slice(),i=Object.keys(n.actionWeights||{}),l=Array.from(new Set([...a,...i])),c=Array.isArray(n.actionOrder)?n.actionOrder:[];this.chosenActions=c.length?c.filter((e=>l.includes(e))):l,this.persistOrder(),this.actionInputs=this.chosenActions.map((()=>({reps:"",weight:""}))),this.diffs=this.chosenActions.map((()=>null)),this.actionEntries=this.chosenActions.map((()=>[])),this.showChooseTpl=!1,uni.showLoading({title:"Ê≠£Âú®ËÆ°ÁÆóÂØπÊØî..."}),setTimeout((()=>{this.calcAllDiffs(),uni.hideLoading()}),50)},calcAllDiffs(){let e={};try{e=uni.getStorageInfoSync()}catch(o){return void(this.diffs=this.chosenActions.map((()=>({text:"Êú™ËÆ∞ÂΩï",class:"diff-neutral"}))))}const t=(Array.isArray(e.keys)?e.keys:[]).filter((e=>e.startsWith(this.DAYDATA_PREFIX)));this.chosenActions.forEach(((e,o)=>{const s=[];if(t.forEach((t=>{const o=t.replace(this.DAYDATA_PREFIX,""),n=uni.getStorageSync(t)||{},a=n.actions&&n.actions[e]||0;if(a>0){const e=new Date(o);isNaN(e.getTime())||s.push({date:o,value:a})}})),0===s.length)return void this.$set(this.diffs,o,{text:"Êú™ËÆ∞ÂΩï",class:"diff-neutral"});s.sort(((e,t)=>e.date<t.date?-1:e.date>t.date?1:0));const n=this.date,a=s.findIndex((e=>e.date===n));if(-1===a)return void this.$set(this.diffs,o,{text:"Êú™ËÆ∞ÂΩï",class:"diff-neutral"});const i=s[a].value;if(0===a)this.$set(this.diffs,o,{text:"0kg",class:"diff-neutral"});else{const e=i-s[a-1].value;let t="0kg",n="diff-neutral";e>0?(t=`+${e}kg`,n="diff-positive"):e<0&&(t=`${e}kg`,n="diff-negative"),this.$set(this.diffs,o,{text:t,class:n})}}))},handleEntryTouchStart(e,t){this.pressedEntry={actionIdx:e,entryIdx:t},clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout((()=>{this.pressedEntry.actionIdx===e&&this.pressedEntry.entryIdx===t&&this.handleEntryLongPress(e,t)}),this.longPressThreshold)},handleEntryTouchMove(){clearTimeout(this.longPressTimer)},handleEntryTouchEnd(){clearTimeout(this.longPressTimer),this.pressedEntry={actionIdx:-1,entryIdx:-1}},handleEntryLongPress(e,t){uni.vibrateShort({type:"light"}),uni.showModal({title:"Âà†Èô§ËÆ∞ÂΩï",content:`Á°ÆÂÆöÂà†Èô§ Á¨¨${t+1}ÁªÑ ËÆ∞ÂΩïÔºü`,success:o=>{o.confirm&&this.removeEntry(e,t)}}),this.pressedEntry={actionIdx:-1,entryIdx:-1}},removeEntry(e,t){const o=this.chosenActions[e],s=this.actionEntries[e].splice(t,1)[0],n=this.DAYDATA_PREFIX+this.date,a={templates:{},actions:{},entries:{},...uni.getStorageSync(n)||{}};a.entries[o]=this.actionEntries[e],a.actions[o]=this.actionEntries[e].reduce(((e,t)=>e+t.total),0);const i={};this.chosenActions.forEach((e=>{const t=a.entries[e]||[];i[e]=t.reduce(((e,t)=>e+t.total),0)})),a.templates[this.chosenTplName]={totalWeight:Object.values(i).reduce(((e,t)=>e+t),0),actionWeights:i,actionOrder:[...this.chosenActions]},uni.setStorageSync(n,a),this.persistOrder(),uni.showToast({title:`Â∑≤Âà†Èô§Ôºö${s.input}kg`,icon:"success"}),this.calcAllDiffs()},clearTimer(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)},updateRemaining(){const e=Date.now(),t=Math.ceil((this.endTimestamp-e)/1e3);this.remaining=Math.max(0,t),this.remaining>0&&this.remaining<=10&&uni.vibrateShort(),this.drawCircle(),this.remaining<=0&&!this.notified&&(this.notified=!0,this.clearTimer(),uni.vibrateLong(),this.audioCtx&&this.audioCtx.play(),uni.showToast({title:"ËÆ°Êó∂ÁªìÊùü",icon:"none",duration:2e3}),plus.push.addLocalNotification({id:Date.now(),title:"ËÆ≠ÁªÉËÆ°Êó∂Âô®",content:"ËÆ°Êó∂ÁªìÊùüÔºå‰ºëÊÅØÂ•ΩÂÜçÁªßÁª≠~"}))},openTimerPopup(){uni.vibrateShort(),this.remaining=this.timerDuration,this.showTimerPopup=!0,this.$nextTick((()=>{this.drawCircle(),this.startCountdown()}))},adjustDuration(e){this.timerDuration=Math.max(1,this.timerDuration+e),this.notified=!1,this.completeTimer(),this.openTimerPopup()},completeTimer(){this.showTimerPopup=!1,this.clearTimer()},startCountdown(){this.clearTimer(),this.endTimestamp=Date.now()+1e3*this.remaining,this.updateRemaining(),this.timerInterval=setInterval((()=>{this.updateRemaining()}),1e3)},drawCircle(){const e=uni.createCanvasContext("timerCanvas"),t=250;e.clearRect(0,0,t,t),e.setStrokeStyle("rgba(0, 0, 0, 0.1)"),e.setLineWidth(14),e.beginPath(),e.arc(125,125,110,0,2*Math.PI),e.stroke();const o=this.remaining/this.timerDuration,s=1.5*Math.PI,n=s+2*Math.PI*o;e.setStrokeStyle("#379bff"),e.setLineWidth(17),e.setShadow(0,0,15,"#379bff"),e.beginPath(),e.arc(125,125,110,s,n,!1),e.stroke(),e.draw()},openAddActionPopup(){const e=uni.getStorageSync(this.ACTIONS_KEY)||[];this.availableActions=Array.isArray(e)?e:[],this.filteredActions=this.availableActions.slice(),this.isSearching=!1,this.searchKeyword="",this.selectedActionIdx=null,this.showAddActionPopup=!0},closeAddActionPopup(){this.showAddActionPopup=!1,this.selectedActionIdx=null},filterAvailableActions(){const e=this.searchKeyword.trim().toLowerCase();this.filteredActions=e?this.availableActions.filter((t=>t.toLowerCase().includes(e))):this.availableActions.slice(),this.selectedActionIdx=null},clearSearch(){this.searchKeyword="",this.filterAvailableActions()},selectAction(e){this.selectedActionIdx=e},addSelectedAction(){if(null===this.selectedActionIdx)return void uni.showToast({title:"ËØ∑ÈÄâÊã©‰∏Ä‰∏™Âä®‰Ωú",icon:"none"});const e=this.availableActions[this.selectedActionIdx];if(this.chosenActions.includes(e))return void uni.showToast({title:"Âä®‰ΩúÂ∑≤Âú®ÂàóË°®‰∏≠",icon:"none"});this.chosenActions.push(e),this.actionInputs.push({reps:"",weight:""}),this.diffs.push({text:"Êú™ËÆ∞ÂΩï",class:"diff-neutral"}),this.actionEntries.push([]),this.showAddActionPopup=!1,uni.showToast({title:`Â∑≤Ê∑ªÂä†Ôºö${e}`,icon:"success"});const t=this.DAYDATA_PREFIX+this.date,o=uni.getStorageSync(t)||{},s={templates:o.templates&&"object"==typeof o.templates?o.templates:{},actions:o.actions&&"object"==typeof o.actions?o.actions:{},entries:o.entries&&"object"==typeof o.entries?o.entries:{}};s.entries[e]=[],s.actions[e]=0;const n=s.templates[this.chosenTplName]||{totalWeight:0,actionWeights:{}};n.actionWeights[e]=0,n.totalWeight=Object.values(n.actionWeights).reduce(((e,t)=>e+t),0),s.templates[this.chosenTplName]=n,uni.setStorageSync(t,s)},handleTagTouchStart(e){this.pressedActionIndex=e,this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null),this.longPressTimer=setTimeout((()=>{this.pressedActionIndex===e&&this.handleTagLongPress(e)}),this.longPressThreshold)},handleTagTouchMove(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null)},handleTagTouchEnd(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null),this.pressedActionIndex=-1},handleTagLongPress(e){uni.vibrateShort({type:"light"}),uni.showModal({title:"Âà†Èô§Âä®‰Ωú",content:`Á°ÆÂÆöË¶ÅÂà†Èô§ "${this.chosenActions[e]}" ÂêóÔºüÊ≠§Êìç‰Ωú‰ªÖÂà†Èô§ÂΩìÂ§©Âä®‰ΩúÔºå‰∏ç‰ºöÂΩ±ÂìçÊ®°Êùø„ÄÇ`,success:t=>{t.confirm&&this.removeActionFromDay(e)}}),this.pressedActionIndex=-1,this.longPressTimer=null},removeActionFromDay(e){const t=this.chosenActions[e];this.chosenActions.splice(e,1),this.actionInputs.splice(e,1),this.diffs.splice(e,1),this.actionEntries.splice(e,1);const o=this.DAYDATA_PREFIX+this.date,s={templates:{},actions:{},entries:{},...uni.getStorageSync(o)||{}};delete s.entries[t],delete s.actions[t];const n={};this.chosenActions.forEach((e=>{const t=Array.isArray(s.entries[e])?s.entries[e]:[];n[e]=t.reduce(((e,t)=>e+t.total),0)}));const a=s.templates[this.chosenTplName]||{actionWeights:{},totalWeight:0};a.actionWeights={...n},a.totalWeight=Object.values(n).reduce(((e,t)=>e+t),0);const i=Array.isArray(a.actionOrder)?a.actionOrder:[];a.actionOrder=i.filter((e=>e!==t)),s.templates[this.chosenTplName]=a,uni.setStorageSync(o,s),uni.showToast({title:`Â∑≤Âà†Èô§Âä®‰ΩúÔºö${t}`,icon:"success"}),this.calcAllDiffs()},persistOrder(){const e=this.DAYDATA_PREFIX+this.date,t={templates:{},actions:{},entries:{},...uni.getStorageSync(e)||{}},o=t.templates[this.chosenTplName]||{};o.actionOrder=[...this.chosenActions],t.templates[this.chosenTplName]=o,uni.setStorageSync(e,t)},formatDate(e){const t=e.getFullYear(),o=e.getMonth()+1,s=e.getDate();return t+"-"+(o<10?"0"+o:o)+"-"+(s<10?"0"+s:s)},openAerobicPopup(){this.showChooseTpl=!1,this.showAerobicPopup=!0,this.aerobicName="",this.aerobicTime=null},closeAerobicPopup(){this.showAerobicPopup=!1,this.showChooseTpl=!0},saveAerobic(){if(!this.aerobicName||!this.aerobicTime)return void uni.showToast({title:"ËØ∑Â°´ÂÜôÂêçÁß∞ÂíåÊó∂Èïø",icon:"none"});const e=this.DAYDATA_PREFIX+this.date,t={templates:{},actions:{},entries:{},...uni.getStorageSync(e)||{}};t.templates[this.aerobicName]={totalWeight:this.aerobicTime,actionWeights:{},isAerobic:!0},uni.setStorageSync(e,t);let o=uni.getStorageSync(this.TEMPLATES_KEY)||[];o.find((e=>e.name===this.aerobicName))||(o.push({name:this.aerobicName,color:this.AEROBIC_COLOR,actions:[],isAerobic:!0}),uni.setStorageSync(this.TEMPLATES_KEY,o)),uni.showToast({title:"Â∑≤Ê∑ªÂä†ÊúâÊ∞ß",icon:"success"}),this.showAerobicPopup=!1}},onShow(){this.showTimerPopup&&this.endTimestamp&&this.updateRemaining()},onHide(){},onUnload(){clearInterval(this.timerInterval)}},[["render",function(t,o,s,n,a,i){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["container",a.darkModeClass])},[a.showChooseTpl?(e.openBlock(),e.createElementBlock("view",{key:0,class:"popup-overlay",onClick:o[4]||(o[4]=e.withModifiers(((...e)=>i.closeChooseTpl&&i.closeChooseTpl(...e)),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[0]||(o[0]=(...e)=>i.closeChooseTpl&&i.closeChooseTpl(...e))}),e.createElementVNode("view",{class:"modal-panel fade-in"},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"ËØ∑ÈÄâÊã©Ê®°Êùø"),e.createElementVNode("view",{class:"btn-aerobic",onClick:o[1]||(o[1]=(...e)=>i.openAerobicPopup&&i.openAerobicPopup(...e))},[e.createElementVNode("text",null,"ÊúâÊ∞ß")]),e.createElementVNode("view",{class:"btn-rest",onClick:o[2]||(o[2]=(...e)=>i.openRestPopup&&i.openRestPopup(...e))},[e.createElementVNode("text",null,"‰ºëÊÅØÊó•")]),e.createElementVNode("text",{class:"close-icon",onClick:o[3]||(o[3]=(...e)=>i.closeChooseTpl&&i.closeChooseTpl(...e))},"√ó")]),e.createElementVNode("view",{class:"modal-body"},[e.createElementVNode("scroll-view",{class:"tpl-select-list","scroll-y":"true","show-scrollbar":"false"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.templates,((t,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,class:"tpl-item",style:e.normalizeStyle({backgroundColor:t.color}),onClick:e=>i.chooseTemplate(o)},[e.createElementVNode("text",{style:e.normalizeStyle({color:i.getContrastColor(t.color)})},e.toDisplayString(t.name),5)],12,["onClick"])))),128)),0===a.templates.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"no-data"},[e.createElementVNode("text",null,"ÊöÇÊó†ÂèØÁî®Ê®°ÊùøÔºåËØ∑ËøîÂõûÈ¶ñÈ°µÊñ∞Âª∫")])):e.createCommentVNode("",!0)])])])])):e.createCommentVNode("",!0),e.createElementVNode("scroll-view",{class:"action-list","scroll-y":"true"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.chosenActions,((t,s)=>{var n;return e.openBlock(),e.createElementBlock("view",{key:t,class:"action-row"},[e.createElementVNode("view",{class:"row-top"},[e.createElementVNode("view",{class:"tag-group"},[e.createElementVNode("view",{class:"move-controls"},[e.createElementVNode("button",{onClick:e=>i.moveAction(s,-1),disabled:0===s},"‚Üë",8,["onClick","disabled"]),e.createElementVNode("button",{onClick:e=>i.moveAction(s,1),disabled:s===a.chosenActions.length-1},"‚Üì",8,["onClick","disabled"])]),e.createElementVNode("text",{class:"tag",onClick:e=>i.goHistory(s),onLongpress:e=>i.handleTagLongPress(s)},e.toDisplayString(t),41,["onClick","onLongpress"])]),e.createElementVNode("view",{class:"input-pair"},[e.withDirectives(e.createElementVNode("input",{type:"digit","onUpdate:modelValue":e=>a.actionInputs[s].reps=e,placeholder:"Ê¨°Êï∞",class:"input-reps"},null,8,["onUpdate:modelValue"]),[[e.vModelText,a.actionInputs[s].reps]]),e.createElementVNode("text",{class:"input-mult"},"√ó"),e.withDirectives(e.createElementVNode("input",{type:"number","decimal-length":"1","onUpdate:modelValue":e=>a.actionInputs[s].weight=e,placeholder:"kg",class:"input-weight",onBlur:e=>i.confirmEntry(s)},null,40,["onUpdate:modelValue","onBlur"]),[[e.vModelText,a.actionInputs[s].weight]]),e.createElementVNode("button",{class:"confirm-btn",onClick:e=>i.confirmEntry(s)},"‚úìÔ∏è",8,["onClick"])])]),(null==(n=a.actionEntries[s])?void 0:n.length)>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-entries"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.actionEntries[s],((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,class:"entry-row",onTouchstart:e=>i.handleEntryTouchStart(s,n),onTouchmove:o[5]||(o[5]=(...e)=>i.handleEntryTouchMove&&i.handleEntryTouchMove(...e)),onTouchend:o[6]||(o[6]=(...e)=>i.handleEntryTouchEnd&&i.handleEntryTouchEnd(...e))},[e.createElementVNode("text",{class:"entry-index"},"Á¨¨"+e.toDisplayString(n+1)+"ÁªÑÔºö",1),e.createElementVNode("text",{class:"entry-text"},e.toDisplayString(t.input)+"kg",1)],40,["onTouchstart"])))),128))])):e.createCommentVNode("",!0),null!==a.diffs[s]?(e.openBlock(),e.createElementBlock("view",{key:1,class:"action-diff"},[e.createElementVNode("text",{class:"total-weight"}," ÊÄªÂÆπÈáèÔºö"+e.toDisplayString(i.getTotalWeight(s))+"kg ",1),e.createElementVNode("text",null,"‰∏é‰∏äÊ¨°Áõ∏ÊØîÔºö"),e.createElementVNode("text",{class:e.normalizeClass(a.diffs[s].class)},e.toDisplayString(a.diffs[s].text),3)])):e.createCommentVNode("",!0)])})),128))]),e.createElementVNode("view",{class:"save-row"},[e.createElementVNode("button",{onClick:o[7]||(o[7]=(...e)=>i.openTimerPopup&&i.openTimerPopup(...e))},"‚è± ËÆ°Êó∂Âô®"),e.createElementVNode("button",{class:"add-action-btn",onClick:o[8]||(o[8]=(...e)=>i.openAddActionPopup&&i.openAddActionPopup(...e))},"Ê∑ªÂä†Âä®‰Ωú")]),a.showAddActionPopup?(e.openBlock(),e.createElementBlock("view",{key:1,class:"popup-overlay",onClick:o[16]||(o[16]=e.withModifiers(((...e)=>i.closeAddActionPopup&&i.closeAddActionPopup(...e)),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[9]||(o[9]=(...e)=>i.closeAddActionPopup&&i.closeAddActionPopup(...e))}),e.createElementVNode("view",{class:"modal-panel fade-in"},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"ÈÄâÊã©Ë¶ÅÊ∑ªÂä†ÁöÑÂä®‰Ωú"),e.createElementVNode("view",{class:"search-wrapper"},[a.isSearching?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:1,ref:"searchInput","onUpdate:modelValue":o[11]||(o[11]=e=>a.searchKeyword=e),class:"search-input",placeholder:"ËæìÂÖ•ÂÖ≥ÈîÆËØç",onInput:o[12]||(o[12]=(...e)=>i.filterAvailableActions&&i.filterAvailableActions(...e))},null,544)),[[e.vModelText,a.searchKeyword]]):(e.openBlock(),e.createElementBlock("text",{key:0,class:"search-trigger",onClick:o[10]||(o[10]=e=>{a.isSearching=!0,t.$nextTick((()=>t.$refs.searchInput&&t.$refs.searchInput.focus()))})},"ÊêúÁ¥¢")),a.isSearching&&a.searchKeyword?(e.openBlock(),e.createElementBlock("text",{key:2,class:"clear-search",onClick:o[13]||(o[13]=(...e)=>i.clearSearch&&i.clearSearch(...e))},"Ê∏ÖÁ©∫")):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"close-icon",onClick:o[14]||(o[14]=(...e)=>i.closeAddActionPopup&&i.closeAddActionPopup(...e))},"√ó")]),e.createElementVNode("view",{class:"modal-body"},[e.createElementVNode("scroll-view",{class:"action-select-list","scroll-y":"true","show-scrollbar":"false"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.filteredActions,((t,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,class:e.normalizeClass(["action-tag",{selected:a.selectedActionIdx===o}]),onClick:e=>i.selectAction(o)},[e.createElementVNode("text",null,e.toDisplayString(t),1)],10,["onClick"])))),128)),0===a.filteredActions.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"no-data"},[e.createElementVNode("text",null,"ÊöÇÊó†Âä®‰ΩúÔºåËØ∑ÂÖàÂú®È¶ñÈ°µÊ∑ªÂä†")])):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"modal-footer"},[e.createElementVNode("button",{onClick:o[15]||(o[15]=(...e)=>i.addSelectedAction&&i.addSelectedAction(...e))},"Á°ÆËÆ§Ê∑ªÂä†")])])])):e.createCommentVNode("",!0),a.showTimerPopup?(e.openBlock(),e.createElementBlock("view",{key:2,class:"timer-overlay"},[e.createElementVNode("view",{class:"timer-panel"},[e.createElementVNode("view",{class:"timer-body"},[e.createElementVNode("canvas",{"canvas-id":"timerCanvas",style:{width:"250px",height:"250px",background:"transparent","border-radius":"50%"}}),e.createElementVNode("view",{class:"time-text"},e.toDisplayString(i.displayTime),1)]),e.createElementVNode("view",{class:"timer-footer"},[e.createElementVNode("button",{onClick:o[17]||(o[17]=e.withModifiers((e=>i.adjustDuration(-10)),["stop"]))},"Ôºç10s"),e.createElementVNode("button",{onClick:o[18]||(o[18]=e.withModifiers((e=>i.adjustDuration(10)),["stop"]))},"Ôºã10s"),e.createElementVNode("button",{onClick:o[19]||(o[19]=e.withModifiers(((...e)=>i.completeTimer&&i.completeTimer(...e)),["stop"]))},"ÂÆåÊàê")])])])):e.createCommentVNode("",!0),a.showAerobicPopup?(e.openBlock(),e.createElementBlock("view",{key:3,class:"popup-overlay",onClick:o[26]||(o[26]=e.withModifiers(((...e)=>i.closeAerobicPopup&&i.closeAerobicPopup(...e)),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[20]||(o[20]=(...e)=>i.closeAerobicPopup&&i.closeAerobicPopup(...e))}),e.createElementVNode("view",{class:"modal-panel fade-in",onClick:o[25]||(o[25]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"Ê∑ªÂä†ÊúâÊ∞ß"),e.createElementVNode("text",{class:"close-icon",onClick:o[21]||(o[21]=(...e)=>i.closeAerobicPopup&&i.closeAerobicPopup(...e))},"√ó")]),e.createElementVNode("view",{class:"modal-body"},[e.createElementVNode("view",{class:"input-row1"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[22]||(o[22]=e=>a.aerobicName=e),placeholder:"ÊúâÊ∞ßÂêçÁß∞",class:"action-input"},null,512),[[e.vModelText,a.aerobicName]])]),e.createElementVNode("view",{class:"input-row"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[23]||(o[23]=e=>a.aerobicTime=e),type:"number",placeholder:"Êó∂ÈïøÔºàÂàÜÈíüÔºâ",class:"action-input"},null,512),[[e.vModelText,a.aerobicTime,void 0,{number:!0}]])])]),e.createElementVNode("view",{class:"modal-footer btn-row"},[e.createElementVNode("button",{onClick:o[24]||(o[24]=(...e)=>i.saveAerobic&&i.saveAerobic(...e))},"ÂÆåÊàê")])])])):e.createCommentVNode("",!0),a.showRestPopup?(e.openBlock(),e.createElementBlock("view",{key:4,class:"popup-overlay",onClick:o[32]||(o[32]=e.withModifiers(((...e)=>i.closeRestPopup&&i.closeRestPopup(...e)),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[27]||(o[27]=(...e)=>i.closeRestPopup&&i.closeRestPopup(...e))}),e.createElementVNode("view",{class:"modal-panel fade-in",onClick:o[31]||(o[31]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"‰ºëÊÅØÊó•"),e.createElementVNode("text",{class:"close-icon",onClick:o[28]||(o[28]=(...e)=>i.closeRestPopup&&i.closeRestPopup(...e))},"√ó")]),e.createElementVNode("view",{class:"modal-body"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[29]||(o[29]=e=>a.restReason=e),placeholder:"ËæìÂÖ•Ê†áÈ¢òÔºå‰æãÂ¶ÇËÖø‰º§‰∫ÜÔºåÂß®Â¶àÁ≠âÁ≠â...",class:"action-input rest"},null,512),[[e.vModelText,a.restReason]]),e.createElementVNode("text",{class:"subtitle"},"Â∏∏Áî®ÁêÜÁî±"),e.createElementVNode("view",{class:"tag-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.commonReasons,(t=>(e.openBlock(),e.createElementBlock("text",{key:t,class:"reason-tag",onClick:e=>a.restReason=t},e.toDisplayString(t),9,["onClick"])))),128))])]),e.createElementVNode("view",{class:"modal-footer"},[e.createElementVNode("button",{onClick:o[30]||(o[30]=(...e)=>i.saveRestDay&&i.saveRestDay(...e))},"‰øùÂ≠ò")])])])):e.createCommentVNode("",!0)],2)}],["__scopeId","data-v-e2a60795"]]),N="fitness_daydata_";y("dayData",{state:()=>({date:"",dayData:{templates:{},entries:{},actions:{}}}),getters:{templateNames:e=>Object.keys(e.dayData.templates)},actions:{load(e){this.date=e;const t=uni.getStorageSync(N+e)||{};this.dayData={templates:t.templates||{},entries:t.entries||{},actions:t.actions||{}}},save(){uni.setStorageSync(N+this.date,{...this.dayData})},chooseTemplate(e){const t=e.name;this.dayData.templates[t]||(this.dayData.templates[t]={totalWeight:0,actionWeights:{},actionOrder:[]},this.save())},addEntry(e,t,o){const s=this.dayData;s.entries[e]=s.entries[e]||[];const n=t*o;s.entries[e].push({input:`${t}√ó${o}`,total:n}),s.actions[e]=s.entries[e].reduce(((e,t)=>e+t.total),0);Object.keys(s.templates).forEach((t=>{const o=s.templates[t];o.actionWeights[e]=s.actions[e],o.totalWeight=Object.values(o.actionWeights).reduce(((e,t)=>e+t),0),o.actionOrder.includes(e)||o.actionOrder.push(e)})),this.save()},removeEntry(e,t){const o=this.dayData;o.entries[e].splice(t,1),o.actions[e]=o.entries[e].reduce(((e,t)=>e+t.total),0),Object.values(o.templates).forEach((t=>{t.actionWeights[e]=o.actions[e],t.totalWeight=Object.values(t.actionWeights).reduce(((e,t)=>e+t),0),t.actionOrder=t.actionOrder.filter((t=>t!==e))})),this.save()}}});const S=E({data:()=>({actionName:"",originalName:"",historyItems:[],actionEntries:[],darkMode:!1,darkModeClass:"light",DAYDATA_PREFIX:"fitness_daydata_"}),onLoad(e){e.action?(this.actionName=decodeURIComponent(e.action),this.originalName=this.actionName):this.actionName="Êú™Áü•Âä®‰Ωú",uni.setNavigationBarTitle({title:this.actionName+" ÂéÜÂè≤ËÆ∞ÂΩï"}),this.actStore=T(),this.actStore.load()},mounted(){const e=uni.getStorageSync("darkMode");this.darkMode="auto"===e?"dark"===uni.getSystemInfoSync().theme:!0===e,this.darkModeClass=this.darkMode?"dark":"light",this.updateNavigationBarStyle(this.darkMode),this.buildActionHistory()},methods:{updateNavigationBarStyle(e){uni.setNavigationBarColor({frontColor:e?"#f7f7f7":"#333333",backgroundColor:e?"#121212":"#f5f5f5",animation:{duration:200,timingFunc:"easeIn"}})},onNameBlur(e){const t=e.trim(),o=this.originalName.trim();t&&t!==o&&(this.actStore.renameAction(o,t),this.actionName=t,this.originalName=t,uni.setNavigationBarTitle({title:t+" ÂéÜÂè≤ËÆ∞ÂΩï"}),this.buildActionHistory())},buildActionHistory(){let e={};try{e=uni.getStorageInfoSync()}catch{return this.historyItems=[],void(this.actionEntries=[])}const t=(Array.isArray(e.keys)?e.keys:[]).filter((e=>e.startsWith(this.DAYDATA_PREFIX))),o=[];t.forEach((e=>{var t;const s=e.replace(this.DAYDATA_PREFIX,""),n=uni.getStorageSync(e)||{},a=Array.isArray(null==(t=n.entries)?void 0:t[this.actionName])?n.entries[this.actionName]:[];a.length&&o.push({dateStr:s,totalToday:a.reduce(((e,t)=>e+t.total),0),details:a})})),o.sort(((e,t)=>e.dateStr.localeCompare(t.dateStr)));const s=[],n=[];o.forEach(((e,t)=>{const a=e.dateStr.split("-");s.push({displayDate:`${a[0]}/${a[1]}/${a[2]}`,totalToday:e.totalToday,diffValue:t>0?e.totalToday-o[t-1].totalToday:0}),n.push(e.details)})),this.historyItems=s,this.actionEntries=n}}},[["render",function(t,o,s,n,a,i){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["container",a.darkModeClass])},[e.createElementVNode("view",{class:"header-fixed"},[e.createElementVNode("span",{class:"text"},"ÈáçÂëΩÂêçÔºö"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>a.actionName=e),onBlur:o[1]||(o[1]=e=>i.onNameBlur(a.actionName)),class:"action-name-input"},null,544),[[e.vModelText,a.actionName]])]),e.createElementVNode("view",{class:"history-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.historyItems,((s,n)=>{var i;return e.openBlock(),e.createElementBlock("view",{key:n,class:"history-row"},[e.createElementVNode("view",{class:"left-block"},[(null==(i=a.actionEntries[n])?void 0:i.length)>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-entries"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.actionEntries[n],((s,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"entry-row",onTouchstart:e=>t.handleEntryTouchStart(n,a),onTouchmove:o[2]||(o[2]=(...e)=>t.handleEntryTouchMove&&t.handleEntryTouchMove(...e)),onTouchend:o[3]||(o[3]=(...e)=>t.handleEntryTouchEnd&&t.handleEntryTouchEnd(...e))},[e.createElementVNode("text",{class:"entry-index"},"Á¨¨"+e.toDisplayString(a+1)+"ÁªÑÔºö",1),e.createElementVNode("text",{class:"entry-text"},e.toDisplayString(s.input)+"kg",1)],40,["onTouchstart"])))),128))])):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"total-diff-text"},[e.createTextVNode(" ÊÄªÈáçÔºö"+e.toDisplayString(s.totalToday)+"kg ",1),n>0?(e.openBlock(),e.createElementBlock("text",{key:0,class:e.normalizeClass(s.diffValue>0?"diff-positive":s.diffValue<0?"diff-negative":"diff-neutral")}," ("+e.toDisplayString(s.diffValue>0?"+"+s.diffValue+"kg":s.diffValue+"kg")+") ",3)):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"right-block"},[e.createElementVNode("text",{class:"date-text"},e.toDisplayString(s.displayDate),1)])])})),128)),0===a.historyItems.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"no-data"},[e.createElementVNode("text",null,"ÊöÇÊó†ËØ•Âä®‰ΩúÂéÜÂè≤ËÆ∞ÂΩï")])):e.createCommentVNode("",!0)])],2)}],["__scopeId","data-v-7687d50a"]]);const b=E({data:()=>({templateName:"",originalName:"",chosenActions:[],currentColor:"",showAddActionPopup:!1,availableActions:[],selectedActionIdx:null,showColorPopup:!1,showCustomColorPopup:!1,newColorName:"",newColorCode:"",colorError:"",darkMode:!1,darkModeClass:"light",pressedActionIndex:-1,longPressTimer:null,longPressThreshold:500,pressedColorIndex:-1,longPressColorTimer:null,presetColors:[{name:"Ê∏ÖÊ∞¥Ëìù",value:"#93d5dc"},{name:"ÊùæÁü≥Áªø",value:"#4DB6AC"},{name:"Ëó§ËêùÁ¥´",value:"#8076a3"},{name:"ÂßúÁ∫¢",value:"#eeb8c3"},{name:"ÂÖãËé±Âõ†Ëìù",value:"#002fa7"},{name:"È©¨Â∞îÊñØÁªø",value:"#01847f"},{name:"Áî≥Â∏É‰º¶ÈªÑ",value:"#fbd26a"},{name:"ÊèêÈ¶ôÁ∫¢",value:"#d44848"},{name:"Á≤âÁ∫¢",value:"#f2b9b2"},{name:"ÁéõÁëôÁÅ∞",value:"#cfccc9"},{name:"Ê±âÁôΩÁéâ",value:"#f8f4ed"}],showSearchInput:!1,searchTerm:"",allActions:[]}),computed:{filteredActions(){if(!this.searchTerm)return this.allActions.slice();const e=this.searchTerm.toLowerCase();return this.allActions.filter((t=>t.toLowerCase().includes(e)))}},onLoad(e){e.template&&(this.templateName=decodeURIComponent(e.template),this.originalName=this.templateName,uni.setNavigationBarTitle({title:this.templateName+" Ê®°ÊùøËØ¶ÊÉÖ"})),this.tplStore=w(),this.tplStore.load();const t=uni.getStorageSync("fitness_actions");this.availableActions=Array.isArray(t)?t:[],this.loadTemplateDetail()},onShow(){this.tplStore.load(),this.loadTemplateDetail()},mounted(){const e=uni.getStorageSync("darkMode");this.darkMode="auto"===e?"dark"===uni.getSystemInfoSync().theme:!0===e,this.darkModeClass=this.darkMode?"dark":"light",this.updateNavigationBarStyle(this.darkMode)},methods:{loadTemplateDetail(){const{actions:e,color:t,customColors:o}=this.tplStore.loadTemplateDetail(this.templateName);this.chosenActions=e,this.currentColor=t},goHistory(e){const t=this.chosenActions[e];uni.navigateTo({url:`../actionHistory/actionHistory?action=${encodeURIComponent(t)}`})},onNameBlur(){const e=this.originalName.trim(),t=this.templateName.trim();t&&t!==e&&(this.tplStore.rename(e,t),this.originalName=t,uni.setNavigationBarTitle({title:t}),this.loadTemplateDetail())},addSelectedAction(){if(null==this.selectedActionIdx)return void uni.showToast({title:"ËØ∑ÈÄâÊã©‰∏Ä‰∏™Âä®‰Ωú",icon:"none"});const e=this.availableActions[this.selectedActionIdx];this.chosenActions.includes(e)?uni.showToast({title:"Âä®‰ΩúÂ∑≤Âú®Ê®°Êùø‰∏≠",icon:"none"}):(this.tplStore.addAction(this.templateName,e),this.loadTemplateDetail(),this.showAddActionPopup=!1,uni.showToast({title:`Â∑≤Ê∑ªÂä†Ôºö${e}`,icon:"success"}))},moveAction(e,t){this.tplStore.moveAction(this.templateName,e,e+t),this.loadTemplateDetail()},handleTagTouchStart(e){this.pressedActionIndex=e,clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout((()=>this.handleTagLongPress(e)),this.longPressThreshold)},handleTagTouchMove(){clearTimeout(this.longPressTimer)},handleTagTouchEnd(){clearTimeout(this.longPressTimer),this.pressedActionIndex=-1},handleTagLongPress(e){uni.vibrateShort({type:"light"}),uni.showModal({title:"Âà†Èô§Âä®‰Ωú",content:`Á°ÆÂÆöÂà†Èô§ "${this.chosenActions[e]}" ÂêóÔºü`,success:t=>{t.confirm&&(this.tplStore.removeAction(this.templateName,e),this.loadTemplateDetail())}})},selectColor(e){this.tplStore.setColor(this.templateName,e),this.currentColor=e,this.showColorPopup=!1},clearColor(){this.tplStore.clearColor(this.templateName),this.currentColor=""},addCustomColor(){const e=this.newColorName.trim(),t=this.newColorCode.trim();e?/^#([0-9A-Fa-f]{6})$/.test(t)?(this.tplStore.addCustomColor(this.templateName,e,t),this.closeCustomColorPopup(),this.showColorPopup=!0):this.colorError="ËØ∑ËæìÂÖ•ÂêàÊ≥ï 6 ‰ΩçÂçÅÂÖ≠ËøõÂà∂Ëâ≤Á†Å":this.colorError="ËØ∑ËæìÂÖ•È¢úËâ≤ÂêçÁß∞"},handleColorTouchStart(e){this.pressedColorIndex=e,clearTimeout(this.longPressColorTimer),this.longPressColorTimer=setTimeout((()=>this.handleColorLongPress(e)),this.longPressThreshold)},handleColorTouchMove(){clearTimeout(this.longPressColorTimer)},handleColorTouchEnd(){clearTimeout(this.longPressColorTimer),this.pressedColorIndex=-1},handleColorLongPress(e){var t;const o=this.tplStore.loadTemplateDetail(this.templateName).customColors||[],s=(null==(t=o[e])?void 0:t.name)||"";uni.showModal({title:"Âà†Èô§Ëá™ÂÆö‰πâÈ¢úËâ≤",content:`Á°ÆÂÆöÂà†Èô§ "${s}" ÂêóÔºü`,success:t=>{var s;t.confirm&&(this.tplStore.removeCustomColor(this.templateName,e),this.currentColor===(null==(s=o[e])?void 0:s.value)&&(this.currentColor=""))}})},saveTemplate(){uni.showToast({title:"‰øùÂ≠òÊàêÂäü",icon:"success"}),uni.navigateBack()},updateNavigationBarStyle(e){uni.setNavigationBarColor({frontColor:e?"#f7f7f7":"#333333",backgroundColor:e?"#121212":"#f5f5f5",animation:{duration:200,timingFunc:"easeIn"}})},openAddActionPopup(){this.allActions=uni.getStorageSync("fitness_actions")||[],this.searchTerm="",this.showSearchInput=!1,this.showAddActionPopup=!0,this.availableActions=this.allActions.slice(),this.selectedActionIdx=null},closeAddActionPopup(){this.showAddActionPopup=!1,this.selectedActionIdx=null},selectAction(e){this.selectedActionIdx=e},closeColorPopup(){this.showColorPopup=!1},closeCustomColorPopup(){this.showCustomColorPopup=!1,this.newColorName="",this.newColorCode="",this.colorError=""},getContrastColor(e){if(!e)return"#000000";let t=e.replace("#","");3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);return(299*parseInt(t.slice(0,2),16)+587*parseInt(t.slice(2,4),16)+114*parseInt(t.slice(4,6),16))/1e3>=128?"#000000":"#FFFFFF"}}},[["render",function(t,o,s,n,a,i){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["container",a.darkModeClass])},[e.createElementVNode("view",{class:"header-fixed"},[e.createElementVNode("view",{class:"input-wrapper"},[e.createElementVNode("text",{class:"pen-icon"},"ÈáçÂëΩÂêçÔºöÔ∏èÔ∏è"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>a.templateName=e),placeholder:"Ê®°ÊùøÂêçÁß∞",class:"template-name-input",onBlur:o[1]||(o[1]=(...e)=>i.onNameBlur&&i.onNameBlur(...e))},null,544),[[e.vModelText,a.templateName]])])]),e.createElementVNode("view",{class:"mid-scroll"},[e.createElementVNode("view",{class:"action-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.chosenActions,((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:s,class:"action-row",onTouchstart:e=>i.handleTagTouchStart(s),onTouchmove:o[2]||(o[2]=(...e)=>i.handleTagTouchMove&&i.handleTagTouchMove(...e)),onTouchend:o[3]||(o[3]=(...e)=>i.handleTagTouchEnd&&i.handleTagTouchEnd(...e))},[e.createElementVNode("view",{class:"action-tag"},[e.createElementVNode("button",{class:"move-btn left",onClick:e.withModifiers((e=>i.moveAction(s,-1)),["stop"]),disabled:0===s}," ‚Üë ",8,["onClick","disabled"]),e.createElementVNode("text",{class:"tag-label",onClick:e=>i.goHistory(s)},e.toDisplayString(t),9,["onClick"]),e.createElementVNode("button",{class:"move-btn right",onClick:e.withModifiers((e=>i.moveAction(s,1)),["stop"]),disabled:s===a.chosenActions.length-1}," ‚Üì ",8,["onClick","disabled"])])],40,["onTouchstart"])))),128)),0===a.chosenActions.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"no-data-mid"},[e.createElementVNode("text",null,"ËØ•Ê®°Êùø‰∏ãÊöÇÊó†Âä®‰ΩúÔºåÁÇπÂáª‚ÄúÊ∑ªÂä†Âä®‰Ωú‚ÄùÊ∑ªÂä†")])):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"footer-fixed"},[e.createElementVNode("view",{class:"color-display",onClick:o[4]||(o[4]=e=>a.showColorPopup=!0)},[e.createElementVNode("span",{class:"color-text"},"Ê®°ÊùøÈÖçËâ≤Ôºö"),a.currentColor?(e.openBlock(),e.createElementBlock("view",{key:0,class:"color-circle-lg",style:e.normalizeStyle({backgroundColor:a.currentColor})},null,4)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"no-color-text"},"Êú™ËÆæÁΩÆÈÖçËâ≤"))]),e.createElementVNode("view",{class:"footer-buttons"},[e.createElementVNode("button",{class:"btn-add-action",onClick:o[5]||(o[5]=(...e)=>i.openAddActionPopup&&i.openAddActionPopup(...e))}," Ê∑ªÂä†Âä®‰Ωú "),e.createElementVNode("button",{class:"btn-save",onClick:o[6]||(o[6]=(...e)=>i.saveTemplate&&i.saveTemplate(...e))},"‰øùÂ≠ò")])]),a.showAddActionPopup?(e.openBlock(),e.createElementBlock("view",{key:0,class:"popup-overlay",onClick:o[15]||(o[15]=e.withModifiers(((...e)=>i.closeAddActionPopup&&i.closeAddActionPopup(...e)),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[7]||(o[7]=(...e)=>i.closeAddActionPopup&&i.closeAddActionPopup(...e))}),e.createElementVNode("view",{class:"popup-panel slide-up",onClick:o[14]||(o[14]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"ÈÄâÊã©Ë¶ÅÊ∑ªÂä†ÁöÑÂä®‰Ωú"),e.createElementVNode("view",{class:"search-wrapper"},[a.showSearchInput?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:1,"onUpdate:modelValue":o[9]||(o[9]=e=>a.searchTerm=e),placeholder:"ËØ∑ËæìÂÖ•ÂÖ≥ÈîÆÂ≠ó",class:"search-input",onInput:o[10]||(o[10]=e=>a.availableActions=i.filteredActions)},null,544)),[[e.vModelText,a.searchTerm]]):(e.openBlock(),e.createElementBlock("text",{key:0,class:"search-trigger",onClick:o[8]||(o[8]=e=>a.showSearchInput=!0)}," ÊêúÁ¥¢ ")),a.searchTerm?(e.openBlock(),e.createElementBlock("text",{key:2,class:"clear-search",onClick:o[11]||(o[11]=e=>{a.searchTerm="",a.availableActions=a.allActions})}," Ê∏ÖÁ©∫ ")):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"close-icon",onClick:o[12]||(o[12]=(...e)=>i.closeAddActionPopup&&i.closeAddActionPopup(...e))},"√ó")]),e.createElementVNode("view",{class:"modal-body"},[e.createElementVNode("scroll-view",{class:"action-select-list","scroll-y":"true","show-scrollbar":"false",style:{height:"60vh"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.availableActions,((t,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,class:e.normalizeClass(["template-tag",{selected:a.selectedActionIdx===o}]),onClick:e=>i.selectAction(o)},[e.createElementVNode("text",{class:"tag-text-center"},e.toDisplayString(t),1)],10,["onClick"])))),128)),0===a.availableActions.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"no-data-mid"},[e.createElementVNode("text",null,"ÊöÇÊó†Âä®‰ΩúÔºåËØ∑ÂÖàÂú®È¶ñÈ°µÊ∑ªÂä†")])):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"modal-footer btn-row"},[e.createElementVNode("button",{class:"btn-confirm",onClick:o[13]||(o[13]=(...e)=>i.addSelectedAction&&i.addSelectedAction(...e))}," Á°ÆËÆ§Ê∑ªÂä† ")])])])):e.createCommentVNode("",!0),a.showColorPopup?(e.openBlock(),e.createElementBlock("view",{key:1,class:"color-popup-overlay",onClick:o[23]||(o[23]=e.withModifiers(((...e)=>i.closeColorPopup&&i.closeColorPopup(...e)),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[16]||(o[16]=(...e)=>i.closeColorPopup&&i.closeColorPopup(...e))}),e.createElementVNode("view",{class:"color-popup-center",onClick:o[22]||(o[22]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"color-popup-header"},[e.createElementVNode("text",{class:"clear-color",onClick:o[17]||(o[17]=(...e)=>i.clearColor&&i.clearColor(...e))},"Ê∏ÖÁ©∫È¢úËâ≤"),e.createElementVNode("text",{class:"add-custom-color",onClick:o[18]||(o[18]=(...e)=>t.openCustomColorPopup&&t.openCustomColorPopup(...e))}," Ê∑ªÂä†Ëá™ÂÆö‰πâ "),e.createElementVNode("text",{class:"close-icon",onClick:o[19]||(o[19]=(...e)=>i.closeColorPopup&&i.closeColorPopup(...e))},"√ó")]),e.createElementVNode("scroll-view",{class:"color-popup-body","scroll-y":"true","show-scrollbar":"false"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.presetColors,((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:s,class:"template-tag",style:e.normalizeStyle({backgroundColor:t.value}),onClick:e=>i.selectColor(t.value),onTouchstart:e=>i.handleColorTouchStart(s),onTouchmove:o[20]||(o[20]=(...e)=>i.handleColorTouchMove&&i.handleColorTouchMove(...e)),onTouchend:o[21]||(o[21]=(...e)=>i.handleColorTouchEnd&&i.handleColorTouchEnd(...e))},[e.createElementVNode("text",{class:"tag-text-center",style:e.normalizeStyle({color:i.getContrastColor(t.value)})},e.toDisplayString(t.name),5)],44,["onClick","onTouchstart"])))),128))])])])):e.createCommentVNode("",!0),a.showCustomColorPopup?(e.openBlock(),e.createElementBlock("view",{key:2,class:"color-popup-overlay",onClick:o[30]||(o[30]=e.withModifiers(((...e)=>i.closeCustomColorPopup&&i.closeCustomColorPopup(...e)),["self"]))},[e.createElementVNode("view",{class:"overlay-bg",onClick:o[24]||(o[24]=(...e)=>i.closeCustomColorPopup&&i.closeCustomColorPopup(...e))}),e.createElementVNode("view",{class:"custom-color-popup-center",onClick:o[29]||(o[29]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"color-popup-header"},[e.createElementVNode("text",{class:"modal-title"},"Ê∑ªÂä†Ëá™ÂÆö‰πâÈ¢úËâ≤"),e.createElementVNode("text",{class:"close-icon",onClick:o[25]||(o[25]=(...e)=>i.closeCustomColorPopup&&i.closeCustomColorPopup(...e))},"√ó")]),e.createElementVNode("view",{class:"modal-body"},[e.createElementVNode("view",{class:"input-row-custom"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[26]||(o[26]=e=>a.newColorName=e),placeholder:"È¢úËâ≤ÂêçÁß∞Ôºà‰æãÂ¶ÇÔºöÁèäÁëöÁ∫¢Ôºâ",class:"color-name-input",maxlength:"12"},null,512),[[e.vModelText,a.newColorName]])]),e.createElementVNode("view",{class:"input-row-custom"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[27]||(o[27]=e=>a.newColorCode=e),placeholder:"#RRGGBB",class:"color-code-input",maxlength:"7"},null,512),[[e.vModelText,a.newColorCode]]),e.createElementVNode("button",{class:"btn-add-color",onClick:o[28]||(o[28]=(...e)=>i.addCustomColor&&i.addCustomColor(...e))},"Ê∑ªÂä†")]),a.colorError?(e.openBlock(),e.createElementBlock("view",{key:0,class:"error-text"},e.toDisplayString(a.colorError),1)):e.createCommentVNode("",!0)])])])):e.createCommentVNode("",!0)],2)}],["__scopeId","data-v-c482641a"]]);const D=E({data:()=>({year:0,months:[],activeDays:0,darkMode:!1,darkModeClass:"light",touchStartX:0,longPressTimer:null,longPressThreshold:500,todayYear:(new Date).getFullYear(),todayMonth:(new Date).getMonth()}),onLoad(e){e.year?this.year=parseInt(e.year,10):this.year=(new Date).getFullYear();const t=uni.getStorageSync("darkMode");if("auto"===t){const e=uni.getSystemInfoSync().theme||"light";this.darkMode="dark"===e}else this.darkMode=!0===t;this.darkModeClass=this.darkMode?"dark":"light",this.buildAllMonths(this.year)},onShow(){this.updateNavigationBarStyle(this.darkMode),uni.setNavigationBarTitle({title:`${this.year} Âπ¥`})},mounted(){},methods:{onTouchStart(e){this.touchStartX=e.changedTouches[0].clientX},onTouchEnd(e){const t=e.changedTouches[0].clientX-this.touchStartX;t>50?(this.prevYear(),uni.showLoading({title:"Âä†ËΩΩ‰∏≠‚Ä¶",mask:!0}),setTimeout((()=>{uni.hideLoading()}),300)):t<-50&&(this.nextYear(),uni.showLoading({title:"Âä†ËΩΩ‰∏≠‚Ä¶",mask:!0}),setTimeout((()=>{uni.hideLoading()}),300))},prevYear(){this.year-=1,uni.setNavigationBarTitle({title:`${this.year} Âπ¥`}),this.buildAllMonths(this.year)},nextYear(){this.year+=1,uni.setNavigationBarTitle({title:`${this.year} Âπ¥`}),this.buildAllMonths(this.year)},onBack(){uni.navigateBack()},selectMonth(e){uni.navigateTo({url:`/pages/index/index?year=${this.year}&month=${e}`})},buildAllMonths(e){const t=[];for(let o=0;o<12;o++){const s=[],n=new Date(e,o,1).getDay();for(let e=0;e<n;e++)s.push({key:`empty-${o}-${e}`,day:"",full:"",empty:!0});const a=new Date(e,o+1,0).getDate();for(let t=1;t<=a;t++){const n=new Date(e,o,t),a=this.formatDate(n);s.push({key:`day-${o}-${t}`,day:t,full:a,empty:!1,isToday:a===this.formatDate(new Date)})}t.push({monthIndex:o,days:s})}this.months=t,this.calcActiveDays()},formatDate(e){const t=e.getFullYear(),o=e.getMonth()+1,s=e.getDate();return t+"-"+(o<10?"0"+o:o)+"-"+(s<10?"0"+s:s)},calcActiveDays(){let e=0;this.months.forEach((t=>{t.days.forEach((t=>{if(t.empty)return;const o=t.full,s=this.DAYDATA_PREFIX+o;if((uni.getStorageSync(s)||{}).isRestDay)return;this.getTemplateName(o)&&(e+=1)}))})),this.activeDays=e},getTemplateName(e){const t=uni.getStorageSync("fitness_daydata_"+e)||{};if(t.isRestDay)return null;if(t.templates&&"object"==typeof t.templates){const e=Object.keys(t.templates);if(e.length>0)return e[e.length-1]}return null},getTemplateColor(e){const t=this.getTemplateName(e);if(!t)return"";const o=(uni.getStorageSync("fitness_templates")||[]).find((e=>e.name===t));return o?o.color:""},getContrastColor(e){e&&"object"==typeof e&&"value"in e&&(e=e.value);let t=String(e).replace(/^#/,"").trim();3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3>128?"#000000":"#FFFFFF"},getCellStyle(e){if(e===this.formatDate(new Date))return{backgroundColor:"#0d82cf"};const t=this.getTemplateColor(e);return t?{backgroundColor:t}:{}},updateNavigationBarStyle(e){const t=e?"#121212":"#f5f5f5",o=e?"#f7f7f7":"#333333";uni.setNavigationBarColor({frontColor:o,backgroundColor:t,animation:{duration:200,timingFunc:"easeIn"}})},isCurrentMonth(e){return this.year===this.todayYear&&e===this.todayMonth},getMonthLabelStyle(e){return this.isCurrentMonth(e)?{color:"#117bca"}:{}}}},[["render",function(t,o,s,n,a,i){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["year-container",a.darkModeClass]),onTouchstart:o[0]||(o[0]=(...e)=>i.onTouchStart&&i.onTouchStart(...e)),onTouchend:o[1]||(o[1]=(...e)=>i.onTouchEnd&&i.onTouchEnd(...e))},[e.createElementVNode("view",{class:"year-header"},[e.createElementVNode("text",{class:"year-title"},"‰ªäÂπ¥ËøêÂä®Â§©Êï∞Ôºö"+e.toDisplayString(a.activeDays)+" Â§©",1)]),e.createElementVNode("scroll-view",{class:"year-body","scroll-y":"true",style:{backgroundColor:"transparent"}},[e.createElementVNode("view",{class:"year-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.months,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.monthIndex,class:"month-block",onClick:e=>i.selectMonth(t.monthIndex)},[e.createElementVNode("view",{class:"month-label"},[e.createElementVNode("text",{class:"month-text",style:e.normalizeStyle(i.getMonthLabelStyle(t.monthIndex))},e.toDisplayString(t.monthIndex+1)+"Êúà ",5)]),e.createElementVNode("view",{class:"weekday-row-sm"},[e.createElementVNode("text",{class:"weekday-sm"},"Êó•"),e.createElementVNode("text",{class:"weekday-sm"},"‰∏Ä"),e.createElementVNode("text",{class:"weekday-sm"},"‰∫å"),e.createElementVNode("text",{class:"weekday-sm"},"‰∏â"),e.createElementVNode("text",{class:"weekday-sm"},"Âõõ"),e.createElementVNode("text",{class:"weekday-sm"},"‰∫î"),e.createElementVNode("text",{class:"weekday-sm"},"ÂÖ≠")]),e.createElementVNode("view",{class:"month-days-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.days,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.key,class:"day-cell-sm",style:e.normalizeStyle(t.empty?{}:i.getCellStyle(t.full))},[t.empty?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[],64)):t.isToday?(e.openBlock(),e.createElementBlock("text",{key:1,class:"day-text-sm",style:{color:"#FFFFFF"}},e.toDisplayString(t.day),1)):i.getTemplateColor(t.full)?(e.openBlock(),e.createElementBlock("text",{key:2,class:"day-text-sm",style:e.normalizeStyle({color:i.getContrastColor(i.getTemplateColor(t.full))})},e.toDisplayString(t.day),5)):(e.openBlock(),e.createElementBlock("text",{key:3,class:"day-text-sm"},e.toDisplayString(t.day),1))],4)))),128))])],8,["onClick"])))),128))])])],34)}],["__scopeId","data-v-fb70139c"]]);const V=E({data:()=>({darkMode:!1,darkModeClass:"light",notes:[],newContent:"",showInput:!1,isEditing:!1,editingIdx:null,pressedEntry:{actionIdx:-1,entryIdx:-1},longPressTimer:null,longPressThreshold:600}),onLoad(){const e=uni.getStorageSync("darkMode");if("auto"===e){const e=uni.getSystemInfoSync().theme||"light";this.darkMode="dark"===e}else this.darkMode=!0===e;this.darkModeClass=this.darkMode?"dark":"light",this.updateNavigationBarStyle(this.darkMode);const t=uni.getStorageSync("trainingNotes");t&&(this.notes=JSON.parse(t))},methods:{updateNavigationBarStyle(e){uni.setNavigationBarColor({frontColor:e?"#f7f7f7":"#333333",backgroundColor:e?"#121212":"#f5f5f5",animation:{duration:200,timingFunc:"easeIn"}})},formatDate(e){const t=new Date(e);return`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`},startAdd(){this.isEditing=!1,this.newContent="",this.showInput=!0},startEdit(e){this.isEditing=!0,this.editingIdx=e,this.newContent=this.notes[e].content,this.showInput=!0},saveNote(){this.isEditing?this.$set(this.notes,this.editingIdx,{date:this.notes[this.editingIdx].date,content:this.newContent.trim()}):this.notes.unshift({date:Date.now(),content:this.newContent.trim()}),uni.setStorageSync("trainingNotes",JSON.stringify(this.notes)),this.cancelInput()},cancelInput(){this.showInput=!1,this.newContent="",this.editingIdx=null},removeEntry(e,t){this.notes.splice(t,1),uni.setStorageSync("trainingNotes",JSON.stringify(this.notes))},handleEntryTouchStart(e,t){this.pressedEntry={entryIdx:e},clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout((()=>{this.pressedEntry.entryIdx===e&&this.handleEntryLongPress(e)}),this.longPressThreshold)},handleEntryTouchMove(){clearTimeout(this.longPressTimer)},handleEntryTouchEnd(){clearTimeout(this.longPressTimer),this.pressedEntry={actionIdx:-1,entryIdx:-1}},handleEntryLongPress(e){uni.vibrateShort({type:"light"}),uni.showModal({title:"Âà†Èô§ËÆ∞ÂΩï",content:`Á°ÆÂÆöÂà†Èô§ Á¨¨${e+1}Êù° ËÆ∞ÂΩïÔºü`,success:t=>{t.confirm&&this.removeEntry(null,e)}}),this.pressedEntry={entryIdx:-1}}}},[["render",function(t,o,s,n,a,i){const l=e.resolveComponent("modal");return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["container",a.darkModeClass])},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("button",{class:"add-btn",onClick:o[0]||(o[0]=(...e)=>i.startAdd&&i.startAdd(...e))},"+")]),a.showInput?(e.openBlock(),e.createBlock(l,{key:0,onClose:i.cancelInput},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"input-container"},[e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":o[1]||(o[1]=e=>a.newContent=e),placeholder:"Âú®ËøôÈáåËæìÂÖ•‰Ω†ÁöÑËÆ≠ÁªÉËÆ°Âàí...","auto-height":"",maxlength:"-1",onBlur:o[2]||(o[2]=(...e)=>i.saveNote&&i.saveNote(...e))},null,544),[[e.vModelText,a.newContent]]),e.createElementVNode("button",{onClick:o[3]||(o[3]=(...e)=>i.saveNote&&i.saveNote(...e)),disabled:!a.newContent.trim()},e.toDisplayString(a.isEditing?"‰øÆÊîπ":"‰øùÂ≠ò"),9,["disabled"])])])),_:1},8,["onClose"])):e.createCommentVNode("",!0),e.createElementVNode("scroll-view",{class:"memo-list","scroll-y":""},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.notes,((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:s,class:"memo-item",onClick:e=>i.startEdit(s),onTouchstart:e=>i.handleEntryTouchStart(s,e),onTouchmove:o[4]||(o[4]=(...e)=>i.handleEntryTouchMove&&i.handleEntryTouchMove(...e)),onTouchend:o[5]||(o[5]=(...e)=>i.handleEntryTouchEnd&&i.handleEntryTouchEnd(...e)),style:e.normalizeStyle({display:a.showInput&&a.isEditing&&a.editingIdx===s?"none":"flex"})},[e.createElementVNode("text",{class:"note-date"},e.toDisplayString(i.formatDate(t.date)),1),e.createElementVNode("text",{class:"note-content"},e.toDisplayString(t.content),1)],44,["onClick","onTouchstart"])))),128)),0===a.notes.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty"},[e.createElementVNode("text",null,"ÊöÇÊó∂Ê≤°ÊúâËÆ∞ÂΩïÔºåÁÇπÂáª + Ê∑ªÂä†‰Ω†ÁöÑËÆ≠ÁªÉËÆ°Âàí")])):e.createCommentVNode("",!0)])],2)}],["__scopeId","data-v-846ba4c5"]]);__definePage("pages/index/index",C),__definePage("pages/index/day",A),__definePage("pages/actionHistory/actionHistory",S),__definePage("pages/templateDetail/templateDetail",b),__definePage("pages/year/year",D),__definePage("pages/help/help",V);const x={onLaunch:function(){t("log","at App.vue:4","App Launch")},onShow:function(){t("log","at App.vue:7","App Show")},onHide:function(){t("log","at App.vue:10","App Hide")}};const{app:P,Vuex:B,Pinia:I}=function(){const t=e.createVueApp(x),o=function(){const t=e.effectScope(!0),o=t.run((()=>e.ref({})));let a=[],i=[];const l=e.markRaw({install(e){s(l),l._a=e,e.provide(n,l),e.config.globalProperties.$pinia=l,i.forEach((e=>a.push(e))),i=[]},use(e){return this._a?a.push(e):i.push(e),this},_p:a,_a:null,_e:t,_s:new Map,state:o});return l}();return t.use(o),{app:t,pinia:o}}();uni.Vuex=B,uni.Pinia=I,P.provide("__globalStyles",__uniConfig.styles),P._component.mpType="app",P._component.render=()=>{},P.mount("#app")}(Vue);
